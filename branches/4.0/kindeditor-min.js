(function(V,v){function W(c){return Object.prototype.toString.call(c)==="[object Array]"}function X(c,a){for(var b=0,d=a.length;b<d;b++)if(c===a[b])return b;return-1}function x(c,a){if(W(c))for(var b=0,d=c.length;b<d;b++){if(a.call(c[b],b,c[b])===false)break}else for(b in c)if(c.hasOwnProperty(b))if(a.call(c[b],b,c[b])===false)break}function E(c){return c.replace(/^\s+|\s+$/g,"")}function da(c,a,b){b=b===v?",":b;return(b+a+b).indexOf(b+c+b)>=0}function L(c){function a(b){b=parseInt(b).toString(16).toUpperCase();
return b.length>1?b:"0"+b}return c.replace(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/ig,function(b,d,g,h){return"#"+a(d)+a(g)+a(h)})}function G(c,a){var b={};a=a===v?",":a;var d=c.split(a);x(d,function(g,h){b[h]=true});return b}function xa(c,a,b){if(c.addEventListener)c.addEventListener(a,b,false);else c.attachEvent&&c.attachEvent("on"+a,b)}function M(c,a,b){if(c.removeEventListener)c.removeEventListener(a,b,false);else c.detachEvent&&c.detachEvent("on"+a,b)}function ya(c,a){if(a){var b={},d=
c.nodeName.toLowerCase()==="#document"?c:c.ownerDocument;x(za,function(h,f){b[f]=a[f]});if(!a.target)a.target=a.srcElement||d;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){var g=d.documentElement;d=d.body;a.pageX=a.clientX+(g&&g.scrollLeft||d&&d.scrollLeft||0)-(g&&g.clientLeft||d&&d.clientLeft||0);a.pageY=a.clientY+(g&&g.scrollTop||d&&d.scrollTop||0)-(g&&
g.clientTop||d&&d.clientTop||0)}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==v)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;b.preventDefault=function(){a.preventDefault&&a.preventDefault();a.returnValue=false};b.stopPropagation=function(){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true};b.stop=function(){this.preventDefault();this.stopPropagation()};return b}}function Y(c){var a=
X(c,Z);if(a<0){a=Z.length;Z.push(c);t[a]={}}return a}function ea(c,a,b){var d=Y(c);if(t[d][a]!==v&&t[d][a].length>0){x(t[d][a],function(g,h){h===v&&t[d][a].splice(g,1)});M(c,a,t[d][a][0])}else t[d][a]=[];if(t[d][a].length==0)t[d][a][0]=function(g){x(t[d][a],function(h,f){h>0&&f&&f.call(c,ya(c,g))})};X(b,t[d][a])<0&&t[d][a].push(b);xa(c,a,t[d][a][0])}function fa(c,a,b){var d=Y(c);if(a===v){if(d in t){x(t[d],function(f,e){M(c,f,e[0])});t[d]={}}}else if(t[d][a]!==v&&t[d][a].length>0)if(b===v){M(c,a,
t[d][a][0]);t[d][a]=[]}else{for(var g=0,h=t[d][a].length;g<h;g++)t[d][a][g]===b&&delete t[d][a][g];if(t[d][a].length==2&&t[d][a][1]===v){M(c,a,t[d][a][0]);t[d][a]=[]}}}function ga(c,a){var b=Y(c);t[b][a]!==v&&t[b][a].length>0&&t[b][a][0]()}function ha(c){for(var a={},b=/\s*([\w\-]+)\s*:([^;]*)(;|$)/g,d;d=b.exec(c);){var g=E(d[1].toLowerCase());d=E(L(d[2]));a[g]=d}return a}function ia(c){for(var a={},b=/\s+(?:([\w-:]+)|(?:([\w-:]+)=([^\s"'<>]+))|(?:([\w-:]+)="([^"]*)")|(?:([\w-:]+)='([^']*)'))(?=(?:\s|\/|>)+)/g,
d;d=b.exec(c);)a[d[1]||d[2]||d[4]||d[6]]=(d[2]?d[3]:d[4]?d[5]:d[7])||"";return a}function ja(c){var a="";x(ha(c),function(b,d){a+=b+":"+d+";"});return a}function N(c){c=c.replace(/((?:[\r\n])*)<(\/)?([\w-:]+)(\s*(?:[\w-:]+)(?:=(?:"[^"]*"|'[^']*'|[^\s"'<>]*))?)*\s*(\/)?>((?:[\r\n])*)/g,function(a,b,d,g,h,f,e){a=b||"";d=d||"";g=g.toLowerCase();h=h||"";f=f?" "+f:"";e=e||"";if(f===""&&ka[g])f=" /";if(e)e=" ";if(g!=="script"&&g!=="style")a="";if(h!==""){h=h.replace(/\s*([\w-:]+)=([^\s"'<>]+|"[^"]*"|'[^']*')/g,
function(i,k,j){i=k.toLowerCase();j=j||"";if(j==="")j='""';else{if(i==="style"){j=j.substr(1,j.length-2);j=ja(j);if(j==="")return"";j='"'+j+'"'}/^['"]/.test(j)||(j='"'+j+'"')}return" "+i+"="+j+" "});h=E(h);if(h=h.replace(/\s+/g," "))h=" "+h;return a+"<"+d+g+h+f+">"+e}else return a+"<"+d+g+f+">"+e});return E(c)}function $(c,a){var b=c.ownerDocument||c,d=a.ownerDocument||a;if(b!==d)return false;if(a===d)return false;if(c===b)return true;if(c.nodeType===3)return false;if(a.nodeType===3){a=a.parentNode;
if(!a)return false;if(c===a)return true}if(c.compareDocumentPosition)return!!(c.compareDocumentPosition(a)&16);return c!==a&&c.contains(a)}function O(c,a){a=a.toLowerCase();var b=null;if(F&&P<8){var d=c.ownerDocument.createElement("div");d.appendChild(c.cloneNode(false));d=ia(d.innerHTML.toLowerCase());if(a in d)b=d[a]}else b=c.getAttribute(a,2);if(a==="style"&&b!==null)b=ja(b);return b}function la(c,a){var b=ma(c,a);return b.length>0?b[0]:null}function ma(c,a){function b(n){if(typeof n!="string")return n;
return n.replace(/([^\w\-])/g,"\\$1")}function d(n,r){return n==="*"||n.toLowerCase()===b(r.toLowerCase())}function g(n,r,m){var l=[];(n=(m.ownerDocument||m).getElementById(n.replace(/\\/g,"")))&&d(r,n.nodeName)&&$(m,n)&&l.push(n);return l}function h(n,r,m){var l=m.ownerDocument||m,q=[];if(m.getElementsByClassName){l=m.getElementsByClassName(n.replace(/\\/g,""));for(var u=0,y=l.length,A;u<y;u++){A=l[u];d(r,A.nodeName)&&q.push(A)}}else if(l.querySelectorAll){l=l.querySelectorAll((m.nodeName!=="#document"?
m.nodeName+" ":"")+r+"."+n);u=0;for(y=l.length;u<y;u++){A=l[u];$(m,A)&&q.push(A)}}else{l=m.getElementsByTagName(r);u=0;for(y=l.length;u<y;u++){A=l[u];if(A.nodeType==1)(r=A.className)&&(" "+r+" ").indexOf(" "+n+" ")>-1&&q.push(A)}}return q}function f(n,r,m,l){var q=[];m=l.getElementsByTagName(m);l=0;for(var u=m.length,y;l<u;l++){y=m[l];if(y.nodeType==1)if(r===null)O(y,n)!==null&&q.push(y);else r===b(O(y,n))&&q.push(y)}return q}function e(n,r){var m=[],l,q=(l=/^((?:\\.|[^.#\s\[<>])+)/.exec(n))?l[1]:
"*";if(l=/#((?:[\w\-]|\\.)+)$/.exec(n))m=g(l[1],q,r);else if(l=/\.((?:[\w\-]|\\.)+)$/.exec(n))m=h(l[1],q,r);else if(l=/\[((?:[\w\-]|\\.)+)\]/.exec(n))m=f(l[1].toLowerCase(),null,q,r);else if(l=/\[((?:[\w\-]|\\.)+)\s*=\s*['"]?((?:\\.|[^'"]+)+)['"]?\]/.exec(n)){m=l[1].toLowerCase();l=l[2];if(m==="id")q=g(l,q,r);else{if(m==="class")q=h(l,q,r);else{if(m==="name"){m=[];l=r.getElementsByName(l.replace(/\\/g,""));for(var u=0,y=l.length,A;u<y;u++){A=l[u];d(q,A.nodeName)&&A.getAttributeNode("name")&&m.push(A)}q=
m}else q=f(m,l,q,r);q=q}q=q}m=q}else{q=r.getElementsByTagName(q);l=0;for(u=q.length;l<u;l++){y=q[l];y.nodeType==1&&m.push(y)}}return m}a=a||document;for(var i=[],k,j=/((?:\\.|[^\s>])+|[\s>])/g;k=j.exec(c);)k[1]!==" "&&i.push(k[1]);k=[];if(i.length==1)return e(i[0],a);var o=false;j=0;for(var w=i.length;j<w;j++){var s=i[j];if(s===">")o=true;else{if(j>0){var B=[];x(k,function(n,r){x(e(s,r),function(m,l){if(o)r===l.parentNode&&B.push(l);else B.push(l)})});k=B}else k=e(s,a);if(k.length==0)return[]}}return k}
function p(c,a){var b;if(typeof c==="string")if(/<.+>/.test(c)){var d=a?a.ownerDocument||a:document,g=d.createElement("div");g.innerHTML=c;b=g.firstChild;g=null}else b=la(c,a);else b=c;if(!b)return null;d=b.ownerDocument||b;var h=d.parentWindow||d.defaultView,f="";g={name:b.nodeName.toLowerCase(),type:b.nodeType,doc:d,bind:function(e,i){ea(b,e,i);return this},unbind:function(e,i){fa(b,e,i);return this},fire:function(e){ga(b,e);return this},hasAttr:function(e){return O(b,e)},attr:function(e,i){if(e===
v)return ia(this.outer());else if(i===v){i=O(b,e);return i===null?"":i}else{if(F&&P<8&&e.toLowerCase()=="class")e="className";b.setAttribute(e,""+i);return this}},removeAttr:function(e){if(F&&P<8&&e.toLowerCase()=="class")e="className";this.attr(e,"");b.removeAttribute(e);return this},get:function(){return b},hasClass:function(e){return da(e,b.className," ")},addClass:function(e){if(!this.hasClass(e))b.className=E(b.className+" "+e);return this},removeClass:function(e){if(this.hasClass(e))b.className=
E(b.className.replace(new RegExp("s*"+e+"s*"),""));return this},html:function(e){if(e===v)return N(b.innerHTML);else{b.innerHTML=N(e);return this}},val:function(e){if(e===v)return this.hasVal()?b.value:this.attr("value");else{if(this.hasVal())b.value=e;else this.attr("value",e);return this}},css:function(e,i){var k=this;if(e===v)return ha(this.attr("style"));if(typeof e==="object"){x(e,function(j,o){k.css(j,o)});return this}if(i===v)return b.style[e]||this.computedCss(e)||"";b.style[na(e)]=i;return this},
computedCss:function(e){var i=na(e),k="";if(h.getComputedStyle){k=h.getComputedStyle(b,null);k=k[i]||k.getPropertyValue(e)||b.style[i]}else if(b.currentStyle)k=b.currentStyle[i]||b.style[i];return k},clone:function(e){return p(b.cloneNode(e))},append:function(e){b.appendChild(H(e));return this},before:function(e){b.parentNode.insertBefore(H(e),b);return this},after:function(e){b.nextSibling?b.parentNode.insertBefore(H(e),b.nextSibling):this.append(e);return this},replaceWith:function(e){b.parentNode.replaceChild(H(e),
b);this.unbind();b=H(e);return this},remove:function(){this.unbind();var e=d.createElement("div");e.appendChild(b);b=e.innerHTML=null;return this},show:function(){this.computedCss("display")==="none"&&this.css("display",f);return this},hide:function(){if(this.computedCss("display")!=="none"){f=this.css("display");this.css("display","none")}return this},outer:function(){var e=d.createElement("div");e.appendChild(b);return N(e.innerHTML)},hasVal:function(){return!!Aa[this.name]},isSingle:function(){return!!ka[this.name]},
isInline:function(){return!!Ba[this.name]},isBlock:function(){return!!Ca[this.name]},contains:function(e){return $(b,H(e))},parent:function(){return p(b.parentNode)},prev:function(){return p(b.previousSibling)},next:function(){return p(b.nextSibling)},each:function(e,i){function k(j){if(j=i?j.first:j.last)for(;j;){var o=i?j.next():j.prev();if(e(j))return true;if(k(j))return;j=o}}i=i===v?true:i;k(this)},toString:function(){return this.type==3?b.nodeValue:this.outer()}};Da.call(g,b);return g}function H(c){return c.get?
c.get():c}function na(c){var a=c.split("-");c="";x(a,function(b,d){c+=b>0?d.charAt(0).toUpperCase()+d.substr(1):d});return c}function Da(c){for(var a=[],b=c.firstChild;b;){if(b.nodeType!=3||E(b.nodeValue)!=="")a.push(p(b));b=b.nextSibling}if(a.length>0){this.first=a[0];this.last=a[a.length-1]}else this.first=this.last=null;this.children=a;a=-1;for(c=c;c;){a++;c=c.previousSibling}this.index=a}function C(c){if(!c.nodeName)return c.get?c:Ea(c);return{startContainer:c,startOffset:0,endContainer:c,endOffset:0,
collapsed:true,commonAncestorContainer:c,setStart:function(a,b){this.startContainer=a;this.startOffset=b;if(this.endContainer===c){this.endContainer=a;this.endOffset=b}oa.call(this,c);pa.call(this);qa.call(this,c);return this},setEnd:function(a,b){this.endContainer=a;this.endOffset=b;if(this.startContainer===c){this.startContainer=a;this.startOffset=b}oa.call(this,c);pa.call(this);qa.call(this,c);return this},setStartBefore:function(a){return this.setStart(a.parentNode||c,p(a).index)},setStartAfter:function(a){return this.setStart(a.parentNode||
c,p(a).index+1)},setEndBefore:function(a){return this.setEnd(a.parentNode||c,p(a).index)},setEndAfter:function(a){return this.setEnd(a.parentNode||c,p(a).index+1)},selectNode:function(a){this.setStartBefore(a);this.setEndAfter(a);return this},selectNodeContents:function(a){var b=p(a);if(b.type==3||b.isSingle())this.selectNode(a);else if(b.children.length>0){this.setStartBefore(b.first.get());this.setEndAfter(b.last.get())}else{this.setStart(a,0);this.setEnd(a,0)}return this},collapse:function(a){a?
this.setEnd(this.startContainer,this.startOffset):this.setStart(this.endContainer,this.endOffset);return this},compareBoundaryPoints:function(a,b){var d=this.get(),g=b.get();if(c.createRange)return d.compareBoundaryPoints(a,g);else{var h={};h[I]="StartToStart";h[J]="EndToStart";h[Q]="EndToEnd";h[K]="StartToEnd";d=d.compareEndPoints(h[a],g);if(d!==0)return d;var f,e,i,k;if(a===I||a===K){f=this.startContainer;i=this.startOffset}if(a===J||a===Q){f=this.endContainer;i=this.endOffset}if(a===I||a===J){e=
b.startContainer;k=b.startOffset}if(a===Q||a===K){e=b.endContainer;k=b.endOffset}if(f===e){f=i-k;return f>0?1:f<0?-1:0}for(d=e;d&&d.parentNode!==f;)d=d.parentNode;if(d)return p(d).index>=i?-1:1;for(d=f;d&&d.parentNode!==e;)d=d.parentNode;if(d)return p(d).index>=k?1:-1}},cloneRange:function(){var a=C(c);a.setStart(this.startContainer,this.startOffset);a.setEnd(this.endContainer,this.endOffset);return a},toString:function(){var a=this.get();return(c.createRange?a.toString():a.text).replace(/\r\n|\n|\r/g,
"")},cloneContents:function(){return aa.call(this,c,true,false)},deleteContents:function(){return aa.call(this,c,false,true)},extractContents:function(){return aa.call(this,c,true,true)},insertNode:function(a){var b=this.startContainer,d=this.startOffset,g=this.endContainer,h=this.endOffset,f,e,i,k,j=b==g,o=a.nodeName.toLowerCase()==="#document-fragment";if(g.nodeType==1&&h>0){i=g.childNodes[h-1];if(i.nodeType==3)if(j=b==i)k=i.nodeValue.length}if(b.nodeType==1)if(b.childNodes.length>0)f=b.childNodes[d];
else e=b;else if(d==0)f=b;else if(d<b.length){f=b.splitText(d);if(j){k=k?k-d:this.endOffset-d;this.setEnd(f,k)}}else if(b.nextSibling)f=b.nextSibling;else e=b.parentNode;f&&f.parentNode.insertBefore(a,f);e&&e.appendChild(a);if(o){a.firstChild&&this.setStartBefore(a.firstChild);if(this.collapsed){if(f)i=f.previousSibling;if(e)i=e.lastChild}}else{this.setStartBefore(a);if(this.collapsed)i=a}i&&this.setEndAfter(i);return this},surroundContents:function(a){a.appendChild(this.extractContents());return this.insertNode(a)},
get:function(){var a=this.startContainer,b=this.startOffset,d=this.endContainer,g=this.endOffset,h;if(c.createRange){h=c.createRange();h.setStart(a,b);h.setEnd(d,g)}else{h=c.body.createTextRange();h.setEndPoint("StartToStart",ra(a,b));h.setEndPoint("EndToStart",ra(d,g))}return h},html:function(){return p(this.cloneContents()).outer()}}}function pa(){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset}function qa(){function c(i){for(var k=[];i;){k.push(i);i=i.parentNode}return k}
for(var a=c(this.startContainer),b=c(this.endContainer),d=0,g=a.length,h=b.length,f,e;++d;){f=a[g-d];e=b[h-d];if(!f||!e||f!==e)break}this.commonAncestorContainer=a[g-d+1]}function oa(c){var a=C(c);c=C(c);a.startContainer=a.endContainer=this.startContainer;a.startOffset=a.endOffset=this.startOffset;c.startContainer=c.endContainer=this.endContainer;c.startOffset=c.endOffset=this.endOffset;if(a.compareBoundaryPoints(I,c)==1){this.startContainer=this.endContainer;this.startOffset=this.endOffset}}function aa(c,
a,b){function d(n,r,m){var l=n.nodeValue.length,q;if(a){q=n.cloneNode(true).splitText(r);q.splitText(m-r)}if(b){var u=n;if(r>0)u=n.splitText(r);m<l&&u.splitText(m-r);j.push(u)}return q}function g(n){return n==f&&n==i?d(n,e,k):n==f?d(n,e,n.nodeValue.length):n==i?d(n,0,k):d(n,0,n.nodeValue.length)}function h(n,r){for(var m=n.firstChild;m;){var l=C(c);l.selectNode(m);if(l.compareBoundaryPoints(K,o)>=0)return false;var q=m.nextSibling;if(l.compareBoundaryPoints(J,o)>0){var u=m.nodeType;if(u==1)if(l.compareBoundaryPoints(I,
o)>=0){a&&r.appendChild(m.cloneNode(true));b&&j.push(m)}else{var y;if(a){y=m.cloneNode(false);r.appendChild(y)}if(!h(m,y))return false}else if(u==3)(m=g(m))&&r.appendChild(m)}m=q}return true}var f=this.startContainer,e=this.startOffset,i=this.endContainer,k=this.endOffset,j=[],o=this;if(b){o=this.cloneRange();this.collapse(true);if(f.nodeType==3&&e==0){this.setStart(f.parentNode,0);this.setEnd(f.parentNode,0)}}var w=c.createDocumentFragment(),s=o.commonAncestorContainer;if(s.nodeType==3)(s=g(s))&&
w.appendChild(s);else h(s,w);s=0;for(var B=j.length;s<B;s++)p(j[s]).remove();return a?w:this}function sa(c,a){var b=c.parentElement().ownerDocument,d=C(b),g=c.duplicate();g.collapse(a);var h=g.parentElement(),f=h.childNodes;if(f.length==0){d.selectNode(h);return{node:d.startContainer,offset:d.startOffset}}b=b;var e=0,i=false,k=c.duplicate();k.moveToElementText(h);for(var j=0,o=f.length;j<o;j++){var w=f[j],s=k.compareEndPoints("StartToStart",g);if(s>0)i=true;if(s==0)return{node:w.parentNode,offset:j};
if(w.nodeType==1){s=c.duplicate();s.moveToElementText(w);k.setEndPoint("StartToEnd",s);if(i)e+=s.text.length;else e=0}else if(w.nodeType==3){k.moveStart("character",w.nodeValue.length);e+=w.nodeValue.length}i||(b=w)}if(!i&&b.nodeType==1){d.setStartAfter(h.lastChild);return{node:d.startContainer,offset:d.startOffset}}k=c.duplicate();k.moveToElementText(h);k.setEndPoint("StartToEnd",g);e-=k.text.length;return{node:b,offset:e}}function Ea(c){if(F){var a=c.parentElement().ownerDocument;if(c.item){a=C(a);
a.selectNode(c.item(0));return a}var b=sa(c,true);c=sa(c,false);a=C(a);a.setStart(b.node,b.offset);a.setEnd(c.node,c.offset)}else{b=c.startContainer;a=b.ownerDocument||b;a=C(a);a.setStart(b,c.startOffset);a.setEnd(c.endContainer,c.endOffset)}return a}function ta(c){var a=c.ownerDocument,b=0;for(c=c.previousSibling;c;){if(c.nodeType==1)if(p(c).isSingle())b+=1;else{var d=a.body.createTextRange();d.moveToElementText(c);b+=d.text.length}else if(c.nodeType==3)b+=c.nodeValue.length;c=c.previousSibling}return b}
function ra(c,a){var b=c.ownerDocument||c,d=b.body.createTextRange();if(b==c){d.collapse(true);return d}if(c.nodeType==1){var g=c.childNodes,h,f=false;if(a==0){h=g[0];g=true}else{h=g[a-1];g=false}if(!h){var e=b.createTextNode(" ");c.appendChild(e);h=e;f=true}if(h.nodeName.toLowerCase()==="head"){if(a===1)g=true;if(a===2)g=false;d.collapse(g);return d}if(h.nodeType==1){d.moveToElementText(h);d.collapse(g)}else{d.moveToElementText(c);f&&c.removeChild(e);b=ta(h);b=g?b:b+h.nodeValue.length;d.moveStart("character",
b)}}else if(c.nodeType==3){d.moveToElementText(c.parentNode);d.moveStart("character",a+ta(c))}return d}function ba(c){var a,b,d;if(c.nodeName){b=c.ownerDocument||c;a=ua(b);try{d=a.rangeCount>0?a.getRangeAt(0):a.createRange()}catch(g){}c=d||b;if(F)if(!d||d.parentElement().ownerDocument!==b)return null}else{d=c.startContainer;b=d.ownerDocument||d;a=ua(b);d=c.get()}var h=C(c);return{wrap:function(f){var e=p(f,b);if(!e.isInline()){f=e.clone(false);h.surroundContents(f.get());R(a,h);return this}if(h.collapsed){f=
e.clone(false);h.insertNode(f.get());h.selectNodeContents(f.get());R(a,h);return this}f=h.extractContents();var i=e.name;p(f).each(function(k){if(k.type==3&&k.parent().name!==i){var j=e.clone(false);j.append(k.clone(true));k.replaceWith(j)}else if(k.name===i){x(e.attr(),function(o,w){o!=="style"&&k.attr(o,w)});x(e.css(),function(o,w){k.css(o,w)})}});h.insertNode(f);R(a,h);return this},remove:function(){if(h.collapsed)return this;var f=h.extractContents(),e=wrapper.name;p(f).each(function(i){if(i.type==
3&&i.parent().name!==e){var k=wrapper.clone(false);k.append(i.clone(true));i.replaceWith(k)}else if(i.name===e){x(wrapper.attr(),function(j,o){j!=="style"&&i.attr(j,o)});x(wrapper.css(),function(j,o){i.css(j,o)})}});h.insertNode(f);R(a,h);return this},exec:function(f,e){return this[f.toLowerCase()](e)},state:function(f){var e=false;try{e=b.queryCommandState(f)}catch(i){}return e},val:function(f){f=f.toLowerCase();var e="";if(f==="fontfamily"||f==="fontname"){e=va(b,"fontname");e=e.replace(/['"]/g,
"");return e.toLowerCase()}if(f==="formatblock"){e=va(b,f);if(e==="")if(f=S(h,{"h1,h2,h3,h4,h5,h6,p,div,pre,address":"*"}))e=f.nodeName;if(e==="Normal")e="p";return e.toLowerCase()}if(f==="fontsize"){if(f=S(h,{"*":".font-size"}))e=p(f).css("font-size");return e.toLowerCase()}if(f==="forecolor"){if(f=S(h,{"*":".color"}))e=p(f).css("color");e=L(e);if(e==="")e="default";return e.toLowerCase()}if(f==="hilitecolor"){S(h,{"*":".background-color"});e=L(e);if(e==="")e="default";return e.toLowerCase()}return e},
bold:function(){return this.wrap("<strong></strong>")},italic:function(){return this.wrap("<em></em>")},forecolor:function(f){return this.wrap('<span style="color:'+f+';"></span>')},hilitecolor:function(f){return this.wrap('<span style="background-color:'+f+';"></span>')},fontsize:function(f){return this.wrap('<span style="font-size:'+f+';"></span>')},fontname:function(f){return this.fontfamily(f)},fontfamily:function(f){return this.wrap('<span style="font-family:'+f+';"></span>')},removeformat:function(){var f=
{"*":"class,style"},e=_INLINE_TAGS.split(",");x(e,function(i,k){f[k]="*"});this.remove(f);return this}}}function va(c,a){var b=c.queryCommandValue(a);if(typeof b!=="string")b="";return b}function ua(c){var a=c.parentWindow||c.defaultView;return a.getSelection?a.getSelection():c.selection}function R(c,a){var b=a.startContainer,d=a.endContainer,g=b.ownerDocument||b,h=g.parentWindow||g.defaultView;if(F&&b.nodeType==1&&a.collapsed){b=g.createTextNode(" ");d.appendChild(b);g=g.body.createTextRange();g.moveToElementText(d);
g.collapse(false);g.select();d.removeChild(b)}else{g=a.get();if(F)g.select();else{c.removeAllRanges();c.addRange(g)}}h.focus()}function S(c,a){for(var b=c.commonAncestorContainer;b;){if(wa(b,a,"*"))return b;if(wa(b,a))return b;b=b.parentNode}return null}function wa(c,a,b){c=p(c);b=b||c.name;var d,g={};if(c.type!==1)return false;x(a,function(f,e){d=f.split(",");for(var i=0,k=d.length,j=d[i];i<k;i++)g[j]=e});if(g[b]){d=g[b].split(",");a=0;b=d.length;for(var h=d[a];a<b;a++){if(h.charAt(0)==="."&&c.css(h.substr(1))!==
"")return true;if(h.charAt(0)!=="."&&c.attr(h)!=="")return true}}return false}function Fa(c){return c.contentDocument||c.contentWindow.document}function Ga(c,a){var b=['<!doctype html><html><head><meta charset="utf-8" /><title>KindEditor</title>'];if(a){if(typeof a=="string"&&!/\{[\s\S]*\}/g.test(a))a=[a];W(a)?x(a,function(d,g){g!==""&&b.push('<link href="'+g+'" rel="stylesheet" />')}):b.push("<style>"+a+"</style>")}b.push("</head><body "+(c?'class="'+c+'"':"")+"></body></html>");return b.join("")}
function T(c){var a=this.doc.body;if(c===v)return p(a).html();else{p(a).html(c);return this}}function U(c){var a=this.textarea;if(c===v)return a.val();else{a.val(c);return this}}var D=navigator.userAgent.toLowerCase(),F=D.indexOf("msie")>-1&&D.indexOf("opera")==-1,ca=D.indexOf("gecko")>-1&&D.indexOf("khtml")==-1,Ha=D.indexOf("applewebkit")>-1,Ia=D.indexOf("opera")>-1,P=(D=/(?:msie|firefox|webkit|opera)[\/:\s](\d+)/.exec(D))?D[1]:"0",Ba=G("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),
Ca=G("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),ka=G("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");G("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");G("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected");var Aa=G("input,button,textarea,select"),z={IE:F,GECKO:ca,
WEBKIT:Ha,OPERA:Ia,VERSION:P,each:x,isArray:W,inArray:X,inString:da,trim:E,toHex:L,toMap:G},za="altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,data,detail,eventPhase,fromElement,handler,keyCode,layerX,layerY,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which".split(","),Z=[],t={};z.bind=ea;z.unbind=fa;z.fire=ga;z.formatHtml=N;
z.query=la;z.queryAll=ma;z.node=p;var I=0,J=1,Q=2,K=3;z.range=C;z.START_TO_START=I;z.START_TO_END=J;z.END_TO_END=Q;z.END_TO_START=K;z.cmd=ba;z.edit=function(c,a){function b(e){return d.hasVal()?d.val(e):d.html(e)}var d=p(c),g=a.designMode===v?true:a.designMode,h=a.bodyClass,f=a.css;return{width:a.width||0,height:a.height||0,html:function(e){this.val(e)},val:function(e){return g?T.call(this,e):U.call(this,e)},create:function(){function e(){var B=ba(s);if(B)j.cmd=B}function i(){x("formatblock,fontfamily,fontsize,forecolor,hilitecolor".split(","),
function(){var B=j.cmd.val(this);console.log(B)})}function k(){var B="justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,indent,outdent,subscript,superscript,bold,italic,underline,strikethrough".split(",");x(B,function(){var n=j.cmd.state(this);console.log(n)})}var j=this;if(j.iframe)return j;var o=p('<iframe class="ke-iframe" frameborder="0"></iframe>');o.css({display:"block",width:j.width,height:j.height});var w=p('<textarea class="ke-textarea"></textarea>');
w.css({display:"block",width:j.width,height:j.height});g?w.hide():o.hide();d.before(o);d.before(w);d.hide();var s=Fa(o.get());s.designMode="on";s.open();s.write(Ga(h,f));s.close();j.iframe=o;j.textarea=w;j.doc=s;g?T.call(j,b()):U.call(j,b());j.cmd=ba(s);j.oninput(e);p(s).bind("mouseup",e);p(document).bind("mousedown",e);j.oninput(i);p(s).bind("click",i);j.oninput(k);p(s).bind("click",k);return j},remove:function(){var e=this.iframe,i=this.textarea,k=this.doc;if(!e)return this;p(k).unbind();p(k.body).unbind();
p(document).unbind();d.show();b(this.val());k.src="javascript:false";e.remove();i.remove();this.iframe=this.textarea=null;return this},toggle:function(e){var i=this.iframe,k=this.textarea;if(!i)return this;if(e===v?!g:e){if(!g){k.hide();T.call(this,U.call(this));i.show();g=true}}else if(g){i.hide();U.call(this,T.call(this));k.show();g=false}return this},toDesign:function(){return this.toggle(true)},toSource:function(){return this.toggle(false)},focus:function(){this.iframe&&g&&this.iframe.contentWindow.focus();
return this},oninput:function(e){function i(o){setTimeout(function(){e(o)},1)}var k=this.doc,j=k.body;p(k).bind("keyup",function(o){if(!o.ctrlKey&&!o.altKey&&(o.keyCode<16||o.keyCode>18)&&o.keyCode!=116){e(o);o.stop()}});p(j).bind("paste",i);p(j).bind("cut",i);return this}}};ca=z;z=function(){};x(ca,function(c,a){z[c]=a});if(V.K===v)V.K=z;V.KindEditor=z})(window);
