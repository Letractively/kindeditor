(function(j,x){function E(c){return Object.prototype.toString.call(c)==="[object Array]"}function C(c,d){if(E(c))for(var a=0,n=c.length;a<n;a++){if(d(a,c[a])===false)break}else for(a in c)if(c.hasOwnProperty(a))if(d(a,c[a])===false)break}function F(c,d){var a={};d=d===x?",":d;var n=c.split(d);C(n,function(k,q){a[q]=true});return a}var y=navigator.userAgent.toLowerCase(),G=y.indexOf("msie")>-1&&y.indexOf("opera")==-1,B=y.indexOf("gecko")>-1&&y.indexOf("khtml")==-1,t=y.indexOf("applewebkit")>-1,v=y.indexOf("opera")>
-1;y=/(?:msie|firefox|webkit|opera)[\/:\s](\d+)/.exec(y);j.KindEditor={IE:G,GECKO:B,WEBKIT:t,OPERA:v,VERSION:y?y[1]:"0",_INLINE_TAG_MAP:F("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),_BLOCK_TAG_MAP:F("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),
_SINGLE_TAG_MAP:F("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),_AUTOCLOSE_TAG_MAP:F("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),_FILL_ATTR_MAP:F("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),each:C,isArray:E,inArray:function(c,d){for(var a=0,n=d.length;a<n;a++)if(c===d[a])return a;return-1},inString:function(c,d,a){a=a===x?",":a;return(a+d+a).indexOf(a+c+a)>=0},trim:function(c){return c.replace(/^\s+|\s+$/g,
"")},toHex:function(c){function d(a){a=parseInt(a).toString(16).toUpperCase();return a.length>1?a:"0"+a}return c.replace(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/ig,function(a,n,k,q){return"#"+d(n)+d(k)+d(q)})},toMap:F}})(window);
(function(j,x){function E(d,a,n){if(d.addEventListener)d.addEventListener(a,n,false);else d.attachEvent&&d.attachEvent("on"+a,n)}function C(d,a,n){if(d.removeEventListener)d.removeEventListener(a,n,false);else d.detachEvent&&d.detachEvent("on"+a,n)}function F(d,a){if(a){var n={},k=d.nodeName.toLowerCase()==="#document"?d:d.ownerDocument;G(t,function(e,b){n[b]=a[b]});if(!a.target)a.target=a.srcElement||k;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=
a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){var q=k.documentElement;k=k.body;a.pageX=a.clientX+(q&&q.scrollLeft||k&&k.scrollLeft||0)-(q&&q.clientLeft||k&&k.clientLeft||0);a.pageY=a.clientY+(q&&q.scrollTop||k&&k.scrollTop||0)-(q&&q.clientTop||k&&k.clientTop||0)}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==x)a.which=a.button&1?1:a.button&2?3:
a.button&4?2:0;n.preventDefault=function(){a.preventDefault&&a.preventDefault();a.returnValue=false};n.stopPropagation=function(){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true};n.stop=function(){this.preventDefault();this.stopPropagation()};return n}}function y(d){var a=B(d,v);if(a<0){a=v.length;v.push(d);c[a]={}}return a}var G=j.each,B=j.inArray,t="altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,data,detail,eventPhase,fromElement,handler,keyCode,layerX,layerY,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which".split(","),
v=[],c={};j.bind=function(d,a,n){var k=y(d);if(c[k][a]!==x&&c[k][a].length>0){G(c[k][a],function(q,e){e===x&&c[k][a].splice(q,1)});C(d,a,c[k][a][0])}else c[k][a]=[];if(c[k][a].length==0)c[k][a][0]=function(q){G(c[k][a],function(e,b){e>0&&b&&b.call(d,F(d,q))})};B(n,c[k][a])<0&&c[k][a].push(n);E(d,a,c[k][a][0])};j.unbind=function(d,a,n){var k=y(d);if(a===x){if(k in c){G(c[k],function(b,h){C(d,b,h[0])});c[k]={}}}else if(c[k][a]!==x&&c[k][a].length>0)if(n===x){C(d,a,c[k][a][0]);c[k][a]=[]}else{for(var q=
0,e=c[k][a].length;q<e;q++)c[k][a][q]===n&&delete c[k][a][q];if(c[k][a].length==2&&c[k][a][1]===x){C(d,a,c[k][a][0]);c[k][a]=[]}}};j.fire=function(d,a){var n=y(d);c[n][a]!==x&&c[n][a].length>0&&c[n][a][0]()}})(KindEditor);
(function(j){function x(B){for(var t={},v=/\s*([\w\-]+)\s*:([^;]*)(;|$)/g,c;c=v.exec(B);){var d=y(c[1].toLowerCase());c=y(G(c[2]));t[d]=c}return t}function E(B){var t="";F(x(B),function(v,c){t+=v+":"+c+";"});return t}var C=j._SINGLE_TAG_MAP,F=j.each,y=j.trim,G=j.toHex;j.formatHtml=function(B){B=B.replace(/((?:[\r\n])*)<(\/)?([\w-:]+)(\s*(?:[\w-:]+)(?:=(?:"[^"]*"|'[^']*'|[^\s"'<>]*))?)*\s*(\/)?>((?:[\r\n])*)/g,function(t,v,c,d,a,n,k){t=v||"";c=c||"";d=d.toLowerCase();a=a||"";n=n?" "+n:"";k=k||"";if(n===
""&&C[d])n=" /";if(k)k=" ";if(d!=="script"&&d!=="style")t="";if(a!==""){a=a.replace(/\s*([\w-:]+)=([^\s"'<>]+|"[^"]*"|'[^']*')/g,function(q,e,b){q=e.toLowerCase();b=b||"";if(b==="")b='""';else{if(q==="style"){b=b.substr(1,b.length-2);b=E(b);if(b==="")return"";b='"'+b+'"'}/^['"]/.test(b)||(b='"'+b+'"')}return" "+q+"="+b+" "});a=y(a);if(a=a.replace(/\s+/g," "))a=" "+a;return t+"<"+c+d+a+n+">"+k}else return t+"<"+c+d+n+">"+k});return y(B)};j._formatCss=E;j._getCssList=x;j._getAttrList=function(B){for(var t=
{},v=/\s+(?:([\w-:]+)|(?:([\w-:]+)=([^\s"'<>]+))|(?:([\w-:]+)="([^"]*)")|(?:([\w-:]+)='([^']*)'))(?=(?:\s|\/|>)+)/g,c;c=v.exec(B);)t[c[1]||c[2]||c[4]||c[6]]=(c[2]?c[3]:c[4]?c[5]:c[7])||"";return t}})(KindEditor);
(function(j){function x(v,c){for(var d=c;d=d.parentNode;)if(d===v)return true;return false}function E(v,c){c=c.toLowerCase();var d=null;if(F&&y<8){var a=v.ownerDocument.createElement("div");a.appendChild(v.cloneNode(false));a=t(a.innerHTML.toLowerCase());if(c in a)d=a[c]}else d=v.getAttribute(c,2);if(c==="style"&&d!==null)d=B(d);return d}function C(v,c){function d(l){if(typeof l!="string")return l;return l.replace(/([^\w\-])/g,"\\$1")}function a(l,f){return l==="*"||l.toLowerCase()===d(f.toLowerCase())}
function n(l,f,o){var m=[];(l=(o.ownerDocument||o).getElementById(l.replace(/\\/g,"")))&&a(f,l.nodeName)&&x(o,l)&&m.push(l);return m}function k(l,f,o){var m=o.ownerDocument||o,A=[];if(o.getElementsByClassName){m=o.getElementsByClassName(l.replace(/\\/g,""));for(var z=0,g=m.length,r;z<g;z++){r=m[z];a(f,r.nodeName)&&A.push(r)}}else if(m.querySelectorAll){m=m.querySelectorAll((o.nodeName!=="#document"?o.nodeName+" ":"")+f+"."+l);z=0;for(g=m.length;z<g;z++){r=m[z];x(o,r)&&A.push(r)}}else{m=o.getElementsByTagName(f);
z=0;for(g=m.length;z<g;z++){r=m[z];if(r.nodeType==1)(f=r.className)&&(" "+f+" ").indexOf(" "+l+" ")>-1&&A.push(r)}}return A}function q(l,f,o,m){var A=[];o=m.getElementsByTagName(o);m=0;for(var z=o.length,g;m<z;m++){g=o[m];if(g.nodeType==1)if(f===null)E(g,l)!==null&&A.push(g);else f===d(E(g,l))&&A.push(g)}return A}function e(l,f){var o=[],m,A=(m=/^((?:\\.|[^.#\s\[<>])+)/.exec(l))?m[1]:"*";if(m=/#((?:[\w\-]|\\.)+)$/.exec(l))o=n(m[1],A,f);else if(m=/\.((?:[\w\-]|\\.)+)$/.exec(l))o=k(m[1],A,f);else if(m=
/\[((?:[\w\-]|\\.)+)\]/.exec(l))o=q(m[1].toLowerCase(),null,A,f);else if(m=/\[((?:[\w\-]|\\.)+)\s*=\s*['"]?((?:\\.|[^'"]+)+)['"]?\]/.exec(l)){o=m[1].toLowerCase();m=m[2];if(o==="id")A=n(m,A,f);else{if(o==="class")A=k(m,A,f);else{if(o==="name"){o=[];m=f.getElementsByName(m.replace(/\\/g,""));for(var z=0,g=m.length,r;z<g;z++){r=m[z];a(A,r.nodeName)&&r.getAttributeNode("name")&&o.push(r)}A=o}else A=q(o,m,A,f);A=A}A=A}o=A}else{A=f.getElementsByTagName(A);m=0;for(z=A.length;m<z;m++){g=A[m];g.nodeType==
1&&o.push(g)}}return o}c=c||document;for(var b=[],h,i=/((?:\\.|[^\s>])+|[\s>])/g;h=i.exec(v);)h[1]!==" "&&b.push(h[1]);h=[];if(b.length==1)return e(b[0],c);var w=false;i=0;for(var u=b.length;i<u;i++){var s=b[i];if(s===">")w=true;else{if(i>0){var p=[];G(h,function(l,f){G(e(s,f),function(o,m){if(w)f===m.parentNode&&p.push(m);else p.push(m)})});h=p}else h=e(s,c);if(h.length==0)return[]}}return h}var F=j.IE,y=j.VERSION,G=j.each,B=j._formatCss,t=j._getAttrList;j._isAncestor=x;j._getAttr=E;j.query=function(v,
c){var d=C(v,c);return d.length>0?d[0]:null};j.queryAll=C})(KindEditor);
(function(j,x){function E(p,l){var f;if(typeof p==="string")if(/<.+>/.test(p)){var o=l?l.ownerDocument||l:document,m=o.createElement("div");m.innerHTML=p;f=m.firstChild;m=null}else f=a(p,l);else f=p;if(!f)return null;o=f.ownerDocument||f;var A=o.parentWindow||o.defaultView,z="";m={name:f.nodeName.toLowerCase(),type:f.nodeType,doc:o,bind:function(g,r){w(f,g,r);return this},unbind:function(g,r){u(f,g,r);return this},fire:function(g){s(f,g);return this},attr:function(g,r){if(g===x)return e(this.outer());
else if(r===x){r=i(f,g);return r===null?"":r}else{if(G&&B<8&&g.toLowerCase()=="class")g="className";f.setAttribute(g,""+r);return this}},removeAttr:function(g){if(G&&B<8&&g.toLowerCase()=="class")g="className";this.attr(g,"");f.removeAttribute(g);return this},get:function(){return f},hasClass:function(g){return k(g,f.className," ")},addClass:function(g){if(!this.hasClass(g))f.className=n(f.className+" "+g);return this},removeClass:function(g){if(this.hasClass(g))f.className=n(f.className.replace(new RegExp("s*"+
g+"s*"),""));return this},html:function(g){if(g===x)return b(f.innerHTML);else{f.innerHTML=b(g);return this}},val:function(g){var r=f.value!=null&&f.value!=="";if(g===x)return r?f.value:this.attr("value");else{if(r)f.value=g;else this.attr("value",g);return this}},css:function(g,r){var D=this;if(g===x)return q(this.attr("style"));if(typeof g==="object"){d(g,function(H,I){D.css(H,I)});return this}if(r===x)return f.style[g]||this.computedCss(g)||"";f.style[F(g)]=r;return this},computedCss:function(g){var r=
F(g),D="";if(A.getComputedStyle){D=A.getComputedStyle(f,null);D=D[r]||D.getPropertyValue(g)||f.style[r]}else if(f.currentStyle)D=f.currentStyle[r]||f.style[r];return D},clone:function(g){return E(f.cloneNode(g))},append:function(g){f.appendChild(C(g));return this},before:function(g){f.parentNode.insertBefore(C(g),f);return this},after:function(g){f.nextSibling?f.parentNode.insertBefore(C(g),f.nextSibling):this.append(g);return this},replaceWith:function(g){f.parentNode.replaceChild(C(g),f);this.unbind();
f=C(g);return this},remove:function(){if(G){var g=o.createElement("div");g.appendChild(f);g.innerHTML=null}else ndoe.parentNode.removeChild(f);this.unbind();f=null;return this},show:function(){this.computedCss("display")==="none"&&this.css("display",z);return this},hide:function(){if(this.computedCss("display")!=="none"){z=this.css("display");this.css("display","none")}return this},outer:function(){var g=o.createElement("div");g.appendChild(f);return b(g.innerHTML)},isSingle:function(){return!!c[this.name]},
isInline:function(){return!!t[this.name]},isBlock:function(){return!!v[this.name]},isAncestor:function(g){return h(C(g),f)},parent:function(){return E(f.parentNode)},prev:function(){return E(f.previousSibling)},next:function(){return E(f.nextSibling)},each:function(g,r){function D(H){if(H=r?H.first:H.last)for(;H;){var I=r?H.next():H.prev();if(g(H))return true;if(D(H))return;H=I}}r=r===x?true:r;D(this)},toString:function(){return this.type==3?f.nodeValue:this.outer()},contain:function(g){var r=this.get();
return r.contains?r!=g&&r.contains(g):!!(r.compareDocumentPosition(g)&16)}};y.call(m,f);return m}function C(p){return p.get?p.get():p}function F(p){var l=p.split("-");p="";d(l,function(f,o){p+=f>0?o.charAt(0).toUpperCase()+o.substr(1):o});return p}function y(p){for(var l=[],f=p.firstChild;f;){if(f.nodeType!=3||n(f.nodeValue)!=="")l.push(E(f));f=f.nextSibling}if(l.length>0){this.first=l[0];this.last=l[l.length-1]}else this.first=this.last=null;this.children=l;l=-1;for(p=p;p;){l++;p=p.previousSibling}this.index=
l}var G=j.IE,B=j.VERSION,t=j._INLINE_TAG_MAP,v=j._BLOCK_TAG_MAP,c=j._SINGLE_TAG_MAP,d=j.each,a=j.query,n=j.trim,k=j.inString,q=j._getCssList,e=j._getAttrList,b=j.formatHtml,h=j._isAncestor,i=j._getAttr,w=j.bind,u=j.unbind,s=j.fire;j.node=E})(KindEditor);
(function(j){function x(e){if(!e.nodeName)return e.get?e:B(e);return{startContainer:e,startOffset:0,endContainer:e,endOffset:0,collapsed:true,commonAncestorContainer:e,setStart:function(b,h){this.startContainer=b;this.startOffset=h;if(this.endContainer===e){this.endContainer=b;this.endOffset=h}F.call(this,e);E.call(this);C.call(this,e);return this},setEnd:function(b,h){this.endContainer=b;this.endOffset=h;if(this.startContainer===e){this.startContainer=b;this.startOffset=h}F.call(this,e);E.call(this);
C.call(this,e);return this},setStartBefore:function(b){return this.setStart(b.parentNode||e,d(b).index)},setStartAfter:function(b){return this.setStart(b.parentNode||e,d(b).index+1)},setEndBefore:function(b){return this.setEnd(b.parentNode||e,d(b).index)},setEndAfter:function(b){return this.setEnd(b.parentNode||e,d(b).index+1)},selectNode:function(b){this.setStartBefore(b);this.setEndAfter(b);return this},selectNodeContents:function(b){var h=d(b);if(h.type==3||h.isSingle())this.selectNode(b);else if(h.children.length>
0){this.setStartBefore(h.first.get());this.setEndAfter(h.last.get())}else{this.setStart(b,0);this.setEnd(b,0)}return this},collapse:function(b){b?this.setEnd(this.startContainer,this.startOffset):this.setStart(this.endContainer,this.endOffset);return this},compareBoundaryPoints:function(b,h){var i=this.get(),w=h.get();if(c){var u={};u[a]="StartToStart";u[n]="EndToStart";u[k]="EndToEnd";u[q]="StartToEnd";i=i.compareEndPoints(u[b],w);if(i!==0)return i;var s,p,l,f;if(b===a||b===q){s=this.startContainer;
l=this.startOffset}if(b===n||b===k){s=this.endContainer;l=s.nodeType==1?this.endOffset-1:this.endOffset}if(b===a||b===n){p=h.startContainer;f=h.startOffset}if(b===k||b===q){p=h.endContainer;f=p.nodeType==1?h.endOffset-1:h.endOffset}if(s===p)return 0;i=s;w=p;if(s.nodeType===1){i=s.childNodes[l];if(i===p){if(b===a||b===q)return-1;if(b===k||b===n)return 1}}if(p.nodeType===1){w=p.childNodes[f];if(w===s){if(b===a||b===q)return 1;if(b===k||b===n)return-1}}if(i&&w===i.nextSibling)return-1;if(w&&i===w.nextSibling)return 1;
s=d(w).isAncestor(i);if(b===a||b===q)return s?-1:1;if(b===k||b===n)return s?1:-1}else return i.compareBoundaryPoints(b,w)},cloneRange:function(){var b=x(e);b.setStart(this.startContainer,this.startOffset);b.setEnd(this.endContainer,this.endOffset);return b},toString:function(){var b=this.get();return(c?b.text:b.toString()).replace(/\r\n|\n|\r/g,"")},cloneContents:function(){return y.call(this,e,true,false)},deleteContents:function(){return y.call(this,e,false,true)},extractContents:function(){return y.call(this,
e,true,true)},insertNode:function(b){var h=this.startContainer,i=this.startOffset,w=this.endContainer,u=this.endOffset,s,p,l,f,o=h==w,m=b.nodeName.toLowerCase()==="#document-fragment";if(w.nodeType==1&&u>0){l=w.childNodes[u-1];if(l.nodeType==3)if(o=h==l)f=l.nodeValue.length}if(h.nodeType==1)if(h.childNodes.length>0)s=h.childNodes[i];else p=h;else if(i==0)s=h;else if(i<h.length){s=h.splitText(i);if(o){f=f?f-i:this.endOffset-i;this.setEnd(s,f)}}else if(h.nextSibling)s=h.nextSibling;else p=h.parentNode;
s&&s.parentNode.insertBefore(b,s);p&&p.appendChild(b);if(m){b.firstChild&&this.setStartBefore(b.firstChild);if(this.collapsed){if(s)l=s.previousSibling;if(p)l=p.lastChild}}else{this.setStartBefore(b);if(this.collapsed)l=b}l&&this.setEndAfter(l);return this},surroundContents:function(b){b.appendChild(this.extractContents());return this.insertNode(b)},get:function(){var b=this.startContainer,h=this.startOffset,i=this.endContainer,w=this.endOffset,u;if(e.createRange){u=e.createRange();u.selectNodeContents(e.body)}else u=
e.body.createTextRange();if(c){u.setEndPoint("StartToStart",v(b,h));u.setEndPoint("EndToStart",v(i,w))}else{u.setStart(b,h);u.setEnd(i,w)}return u},html:function(){return d(this.cloneContents()).outer()}}}function E(){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset}function C(){function e(l){for(var f=[];l;){f.push(l);l=l.parentNode}return f}for(var b=e(this.startContainer),h=e(this.endContainer),i=0,w=b.length,u=h.length,s,p;++i;){s=b[w-i];p=h[u-i];if(!s||
!p||s!==p)break}this.commonAncestorContainer=b[w-i+1]}function F(e){var b=x(e);e=x(e);b.startContainer=b.endContainer=this.startContainer;b.startOffset=b.endOffset=this.startOffset;e.startContainer=e.endContainer=this.endContainer;e.startOffset=e.endOffset=this.endOffset;if(b.compareBoundaryPoints(a,e)==1){this.startContainer=this.endContainer;this.startOffset=this.endOffset}}function y(e,b,h){function i(D,H,I){var J=D.nodeValue.length,L;if(b){L=D.cloneNode(true).splitText(H);L.splitText(I-H)}if(h){var K=
D;if(H>0)K=D.splitText(H);I<J&&K.splitText(I-H);o.push(K)}return L}function w(D){return D==s&&D==l?i(D,p,f):D==s?i(D,p,D.nodeValue.length):D==l?i(D,0,f):i(D,0,D.nodeValue.length)}function u(D,H){for(var I=D.firstChild;I;){var J=x(e);J.selectNode(I);if(J.compareBoundaryPoints(q,m)>=0)return false;var L=I.nextSibling;if(J.compareBoundaryPoints(n,m)>0){var K=I.nodeType;if(K==1)if(J.compareBoundaryPoints(a,m)>=0){b&&H.appendChild(I.cloneNode(true));h&&o.push(I)}else{var M;if(b){M=I.cloneNode(false);H.appendChild(M)}if(!u(I,
M))return false}else if(K==3)(I=w(I))&&H.appendChild(I)}I=L}return true}var s=this.startContainer,p=this.startOffset,l=this.endContainer,f=this.endOffset,o=[],m=this;if(h){m=this.cloneRange();this.collapse(true);if(s.nodeType==3&&p==0){this.setStart(s.parentNode,0);this.setEnd(s.parentNode,0)}}var A=e.createDocumentFragment(),z=m.commonAncestorContainer;if(z.nodeType==3)(z=w(z))&&A.appendChild(z);else u(z,A);z=0;for(var g=o.length;z<g;z++){var r=o[z];r.parentNode.removeChild(r)}return b?A:this}function G(e,
b){var h=e.parentElement().ownerDocument,i=x(h),w=e.duplicate();w.collapse(b);var u=w.parentElement(),s=u.childNodes;if(s.length==0){i.selectNode(u);return{node:i.startContainer,offset:i.startOffset}}var p=h,l=0,f=false,o=e.duplicate();o.moveToElementText(u);for(var m=0,A=s.length;m<A;m++){var z=s[m],g=o.compareEndPoints("StartToStart",w);if(g>0)f=true;if(g==0){i=x(h);z.nodeType==1?i.selectNode(z):i.setStartBefore(z);return{node:i.startContainer,offset:i.startOffset}}if(z.nodeType==1){g=e.duplicate();
g.moveToElementText(z);o.setEndPoint("StartToEnd",g);if(f)l+=g.text.length;else l=0}else if(z.nodeType==3){o.moveStart("character",z.nodeValue.length);l+=z.nodeValue.length}f||(p=z)}if(!f&&p.nodeType==1){i.setStartAfter(u.lastChild);return{node:i.startContainer,offset:i.startOffset}}o=e.duplicate();o.moveToElementText(u);o.setEndPoint("StartToEnd",w);l-=o.text.length;return{node:p,offset:l}}function B(e){if(c){var b=e.parentElement().ownerDocument;if(e.item){b=x(b);b.selectNode(e.item(0));return b}var h=
G(e,true);e=G(e,false);b=x(b);b.setStart(h.node,h.offset);b.setEnd(e.node,e.offset)}else{h=e.startContainer;b=h.ownerDocument||h;b=x(b);b.setStart(h,e.startOffset);b.setEnd(e.endContainer,e.endOffset)}return b}function t(e){var b=e.ownerDocument,h=0;for(e=e.previousSibling;e;){if(e.nodeType==1)if(d(e).isSingle())h+=1;else{var i=b.body.createTextRange();i.moveToElementText(e);h+=i.text.length}else if(e.nodeType==3)h+=e.nodeValue.length;e=e.previousSibling}return h}function v(e,b){var h=e.ownerDocument||
e,i=h.body.createTextRange();if(h==e){i.collapse(true);return i}if(e.nodeType==1){var w=e.childNodes,u,s=false;if(b==0){u=w[0];w=true}else{u=w[b-1];w=false}if(!u){var p=h.createTextNode(" ");e.appendChild(p);u=p;s=true}if(u.nodeName.toLowerCase()==="head"){if(b===1)w=true;if(b===2)w=false;i.collapse(w);return i}if(u.nodeType==1){i.moveToElementText(u);i.collapse(w)}else{i.moveToElementText(e);s&&e.removeChild(p);h=t(u);h=w?h:h+u.nodeValue.length;i.moveStart("character",h)}}else if(e.nodeType==3){i.moveToElementText(e.parentNode);
i.moveStart("character",b+t(e))}return i}var c=j.IE,d=j.node,a=0,n=1,k=2,q=3;j.range=x;j.START_TO_START=a;j.START_TO_END=n;j.END_TO_END=k;j.END_TO_START=q})(KindEditor);
(function(j){function x(t){var v=t.parentWindow||t.defaultView;return v.getSelection?v.getSelection():t.selection}function E(t){function v(e){e=e.get();G?e.select():c.addRange(e);k.focus()}var c,d,a;if(t.nodeName){d=t.nodeName.toLowerCase()==="#document"?t:t.ownerDocument;c=x(d);try{a=c.rangeCount>0?c.getRangeAt(0):c.createRange()}catch(n){}t=a||d;if(G)if(a.parentElement().ownerDocument!==d)return null}else{a=t.startContainer;d=a.ownerDocument||a;c=x(d);a=t.get()}var k=d.parentWindow||d.defaultView,
q=y(t);return{wrap:function(e){var b=F(e,d),h=b.name;e=q.extractContents();F(e).each(function(i){if(i.type==3&&i.parent().name!==h){var w=b.clone(false);w.append(i.clone(true));i.replaceWith(w)}else if(i.name===h){C(b.attr(),function(u,s){u!=="style"&&i.attr(u,s)});C(b.css(),function(u,s){i.css(u,s)})}});q.insertNode(e);v(q)},remove:function(){v(q)},bold:function(){this.wrap("<strong></strong>")},italic:function(){this.wrap("<em></em>")},foreColor:function(e){this.wrap('<span style="color:'+e+';"></span>')},
hiliteColor:function(){this.wrap('<span style="background-color:'+val+';"></span>')},removeFormat:function(){var e={"*":"class,style"},b=B.split(",");C(b,function(h,i){e[i]="*"});this.remove(e)}}}var C=j.each,F=j.node,y=j.range,G=j.IE,B=j.INLINE_TAGS;j.cmd=E;j.execCommand=function(t,v,c,d){t=E(t);t[v].call(t,d)};j.queryCommandValue=function(){}})(KindEditor);
(function(j,x){function E(B){return B.contentDocument||B.contentWindow.document}function C(B,t){var v=['<!doctype html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>KindEditor</title>'];t&&F(t,function(c,d){if(d!=="")v[c+1]='<link href="'+d+'" rel="stylesheet" />'});v.push("</head><body "+(B?'class="'+B+'"':"")+"></body></html>");return v.join("")}var F=j.each,y=j.node,G=j.cmd;j.edit=function(B,t){var v=y(B),c=null;return{cmd:null,doc:null,width:t.width||0,
height:t.height||0,val:function(d){var a=this.doc.body;if(d===x)return y(a).html();else{y(a).html(d);return this}},create:function(){function d(){var k=G(n);if(k)a.cmd=k}var a=this;if(c!==null)return a;c=y('<iframe class="ke-iframe" frameborder="0"></iframe>');c.css({display:"block",width:a.width,height:a.height});v.before(c);v.hide();var n=E(c.get());n.designMode="on";n.open();n.write(C());n.close();a.doc=n;a.val(v.val());a.cmd=G(n);a.oninput(d);y(n).bind("mouseup",d);y(document).bind("mousedown",
d);return a},remove:function(){var d=this.doc;if(c===null)return this;y(d).unbind();y(d.body).unbind();y(document).unbind();v.show();v.val(this.val());d.src="javascript:false";c.remove();c=null;return this},show:function(){c&&c.show();return this},hide:function(){c&&c.hide();return this},focus:function(){c&&c.contentWindow.focus();return this},oninput:function(d){function a(q){setTimeout(function(){d(q)},1)}var n=this.doc,k=n.body;y(n).bind("keyup",function(q){if(!q.ctrlKey&&!q.altKey&&(q.keyCode<
16||q.keyCode>18)&&q.keyCode!=116){d(q);q.stop()}});y(k).bind("paste",a);y(k).bind("cut",a);return this}}}})(KindEditor);(function(j,x){var E=j.each,C=j;j=function(){};E(C,function(F,y){/^_/.test(F)||(j[F]=y)});if(window.K===x)window.K=j;window.KindEditor=j})(KindEditor);
