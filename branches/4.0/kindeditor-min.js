(function($,v){function aa(c){return Object.prototype.toString.call(c)==="[object Array]"}function ba(c,a){for(var b=0,d=a.length;b<d;b++)if(c===a[b])return b;return-1}function z(c,a){if(aa(c))for(var b=0,d=c.length;b<d;b++){if(a.call(c[b],b,c[b])===false)break}else for(b in c)if(c.hasOwnProperty(b))if(a.call(c[b],b,c[b])===false)break}function I(c){return c.replace(/^\s+|\s+$/g,"")}function ia(c,a,b){b=b===v?",":b;return(b+a+b).indexOf(b+c+b)>=0}function Q(c){function a(b){b=parseInt(b,10).toString(16).toUpperCase();
return b.length>1?b:"0"+b}return c.replace(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/ig,function(b,d,h,i){return"#"+a(d)+a(h)+a(i)})}function K(c,a){a=a===v?",":a;var b={},d=c.split(a);z(d,function(h,i){b[i]=true});return b}function Ca(c,a,b){if(c.addEventListener)c.addEventListener(a,b,false);else c.attachEvent&&c.attachEvent("on"+a,b)}function R(c,a,b){if(c.removeEventListener)c.removeEventListener(a,b,false);else c.detachEvent&&c.detachEvent("on"+a,b)}function Da(c,a){if(a){var b={},d=c.nodeName.toLowerCase()===
"#document"?c:c.ownerDocument;z(Ea,function(i,g){b[g]=a[g]});if(!a.target)a.target=a.srcElement||d;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){var h=d.documentElement;d=d.body;a.pageX=a.clientX+(h&&h.scrollLeft||d&&d.scrollLeft||0)-(h&&h.clientLeft||d&&d.clientLeft||0);a.pageY=a.clientY+(h&&h.scrollTop||d&&d.scrollTop||0)-(h&&h.clientTop||d&&d.clientTop||
0)}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==v)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;b.preventDefault=function(){a.preventDefault&&a.preventDefault();a.returnValue=false};b.stopPropagation=function(){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true};b.stop=function(){this.preventDefault();this.stopPropagation()};return b}}function ca(c){var a=ba(c,da);if(a<0){a=
da.length;da.push(c);q[a]={}}return a}function ja(c,a,b){var d=ca(c);if(q[d][a]!==v&&q[d][a].length>0){z(q[d][a],function(h,i){i===v&&q[d][a].splice(h,1)});R(c,a,q[d][a][0])}else q[d][a]=[];if(q[d][a].length===0)q[d][a][0]=function(h){z(q[d][a],function(i,g){i>0&&g&&g.call(c,Da(c,h))})};ba(b,q[d][a])<0&&q[d][a].push(b);Ca(c,a,q[d][a][0])}function ka(c,a,b){var d=ca(c);if(a===v){if(d in q){z(q[d],function(g,e){R(c,g,e[0])});q[d]={}}}else if(q[d][a]!==v&&q[d][a].length>0)if(b===v){R(c,a,q[d][a][0]);
q[d][a]=[]}else{for(var h=0,i=q[d][a].length;h<i;h++)q[d][a][h]===b&&delete q[d][a][h];if(q[d][a].length==2&&q[d][a][1]===v){R(c,a,q[d][a][0]);q[d][a]=[]}}}function la(c,a){var b=ca(c);q[b][a]!==v&&q[b][a].length>0&&q[b][a][0]()}function ma(c){for(var a={},b=/\s*([\w\-]+)\s*:([^;]*)(;|$)/g,d;d=b.exec(c);){var h=I(d[1].toLowerCase());d=I(Q(d[2]));a[h]=d}return a}function na(c){for(var a={},b=/\s+(?:([\w-:]+)|(?:([\w-:]+)=([^\s"'<>]+))|(?:([\w-:]+)="([^"]*)")|(?:([\w-:]+)='([^']*)'))(?=(?:\s|\/|>)+)/g,
d;d=b.exec(c);)a[d[1]||d[2]||d[4]||d[6]]=(d[2]?d[3]:d[4]?d[5]:d[7])||"";return a}function oa(c){var a="";z(ma(c),function(b,d){a+=b+":"+d+";"});return a}function S(c){c=c.replace(/((?:[\r\n])*)<(\/)?([\w-:]+)(\s*(?:[\w-:]+)(?:=(?:"[^"]*"|'[^']*'|[^\s"'<>]*))?)*\s*(\/)?>((?:[\r\n])*)/g,function(a,b,d,h,i,g,e){a=b||"";d=d||"";h=h.toLowerCase();i=i||"";g=g?" "+g:"";e=e||"";if(g===""&&pa[h])g=" /";if(e)e=" ";if(h!=="script"&&h!=="style")a="";if(i!==""){i=i.replace(/\s*([\w-:]+)=([^\s"'<>]+|"[^"]*"|'[^']*')/g,
function(f,k,j){f=k.toLowerCase();j=j||"";if(j==="")j='""';else{if(f==="style"){j=j.substr(1,j.length-2);j=oa(j);if(j==="")return"";j='"'+j+'"'}/^['"]/.test(j)||(j='"'+j+'"')}return" "+f+"="+j+" "});i=I(i);if(i=i.replace(/\s+/g," "))i=" "+i;return a+"<"+d+h+i+g+">"+e}else return a+"<"+d+h+g+">"+e});return I(c)}function ea(c,a){var b=c.ownerDocument||c,d=a.ownerDocument||a;if(b!==d)return false;if(a===d)return false;if(c===b)return true;if(c.nodeType===3)return false;if(a.nodeType===3){a=a.parentNode;
if(!a)return false;if(c===a)return true}if(c.compareDocumentPosition)return!!(c.compareDocumentPosition(a)&16);return c!==a&&c.contains(a)}function T(c,a){a=a.toLowerCase();var b=null;if(J&&U<8){var d=c.ownerDocument.createElement("div");d.appendChild(c.cloneNode(false));d=na(d.innerHTML.toLowerCase());if(a in d)b=d[a]}else b=c.getAttribute(a,2);if(a==="style"&&b!==null)b=oa(b);return b}function qa(c,a){function b(o){if(typeof o!="string")return o;return o.replace(/([^\w\-])/g,"\\$1")}function d(o,
t){return o==="*"||o.toLowerCase()===b(t.toLowerCase())}function h(o,t,p){var m=[];(o=(p.ownerDocument||p).getElementById(o.replace(/\\/g,"")))&&d(t,o.nodeName)&&ea(p,o)&&m.push(o);return m}function i(o,t,p){var m=p.ownerDocument||p,s=[],y,B,C;if(p.getElementsByClassName){m=p.getElementsByClassName(o.replace(/\\/g,""));y=0;for(B=m.length;y<B;y++){C=m[y];d(t,C.nodeName)&&s.push(C)}}else if(m.querySelectorAll){m=m.querySelectorAll((p.nodeName!=="#document"?p.nodeName+" ":"")+t+"."+o);y=0;for(B=m.length;y<
B;y++){C=m[y];ea(p,C)&&s.push(C)}}else{m=p.getElementsByTagName(t);y=0;for(B=m.length;y<B;y++){C=m[y];if(C.nodeType==1)(t=C.className)&&(" "+t+" ").indexOf(" "+o+" ")>-1&&s.push(C)}}return s}function g(o,t,p,m){var s=[];p=m.getElementsByTagName(p);m=0;for(var y=p.length,B;m<y;m++){B=p[m];if(B.nodeType==1)if(t===null)T(B,o)!==null&&s.push(B);else t===b(T(B,o))&&s.push(B)}return s}function e(o,t){var p=[],m,s=(m=/^((?:\\.|[^.#\s\[<>])+)/.exec(o))?m[1]:"*";if(m=/#((?:[\w\-]|\\.)+)$/.exec(o))p=h(m[1],
s,t);else if(m=/\.((?:[\w\-]|\\.)+)$/.exec(o))p=i(m[1],s,t);else if(m=/\[((?:[\w\-]|\\.)+)\]/.exec(o))p=g(m[1].toLowerCase(),null,s,t);else if(m=/\[((?:[\w\-]|\\.)+)\s*=\s*['"]?((?:\\.|[^'"]+)+)['"]?\]/.exec(o)){p=m[1].toLowerCase();m=m[2];if(p==="id")s=h(m,s,t);else{if(p==="class")s=i(m,s,t);else{if(p==="name"){p=[];m=t.getElementsByName(m.replace(/\\/g,""));for(var y=0,B=m.length,C;y<B;y++){C=m[y];d(s,C.nodeName)&&C.getAttributeNode("name")&&p.push(C)}s=p}else s=g(p,m,s,t);s=s}s=s}p=s}else{s=t.getElementsByTagName(s);
m=0;for(y=s.length;m<y;m++){B=s[m];B.nodeType==1&&p.push(B)}}return p}a=a||document;for(var f=[],k,j=/((?:\\.|[^\s>])+|[\s>])/g;k=j.exec(c);)k[1]!==" "&&f.push(k[1]);var l=[];if(f.length==1)return e(f[0],a);k=false;j=0;for(var w=f.length;j<w;j++){var r=f[j];if(r===">")k=true;else{if(j>0){var E=[],x=0,D=l.length;for(l=l[x];x<D;x++){var u=e(r,l),G=0,L=u.length;for(u=u[x];G<L;G++)if(k)l===u.parentNode&&E.push(u);else E.push(u)}l=E}else l=e(r,a);if(l.length===0)return[]}}return l}function ra(c,a){var b=
qa(c,a);return b.length>0?b[0]:null}function M(c){return c.get?c.get():c}function sa(c){var a=c.split("-");c="";z(a,function(b,d){c+=b>0?d.charAt(0).toUpperCase()+d.substr(1):d});return c}function n(c,a){var b;if(typeof c==="string")if(/<.+>/.test(c)){var d=(a?a.ownerDocument||a:document).createElement("div");d.innerHTML=c;b=d.firstChild;d=null}else b=ra(c,a);else b=c;if(!b)return null;var h=b.ownerDocument||b,i=h.parentWindow||h.defaultView,g="";d={name:b.nodeName.toLowerCase(),type:b.nodeType,doc:h,
bind:function(e,f){ja(b,e,f);return this},unbind:function(e,f){ka(b,e,f);return this},fire:function(e){la(b,e);return this},hasAttr:function(e){return T(b,e)},attr:function(e,f){if(e===v)return na(this.outer());else if(f===v){f=T(b,e);return f===null?"":f}else{if(J&&U<8&&e.toLowerCase()=="class")e="className";b.setAttribute(e,""+f);return this}},removeAttr:function(e){if(J&&U<8&&e.toLowerCase()=="class")e="className";this.attr(e,"");b.removeAttribute(e);return this},get:function(){return b},hasClass:function(e){return ia(e,
b.className," ")},addClass:function(e){if(!this.hasClass(e))b.className=I(b.className+" "+e);return this},removeClass:function(e){if(this.hasClass(e))b.className=I(b.className.replace(new RegExp("\\s*"+e+"\\s*"),""));return this},html:function(e){if(e===v)return S(b.innerHTML);else{b.innerHTML=S(e);return this}},val:function(e){if(e===v)return this.hasVal()?b.value:this.attr("value");else{if(this.hasVal())b.value=e;else this.attr("value",e);return this}},css:function(e,f){var k=this;if(e===v)return ma(this.attr("style"));
if(typeof e==="object"){z(e,function(j,l){k.css(j,l)});return this}if(f===v)return b.style[e]||this.computedCss(e)||"";b.style[sa(e)]=f;return this},computedCss:function(e){var f=sa(e),k="";if(i.getComputedStyle){k=i.getComputedStyle(b,null);k=k[f]||k.getPropertyValue(e)||b.style[f]}else if(b.currentStyle)k=b.currentStyle[f]||b.style[f];return k},clone:function(e){return n(b.cloneNode(e))},append:function(e){b.appendChild(M(e));return this},before:function(e){b.parentNode.insertBefore(M(e),b);return this},
after:function(e){b.nextSibling?b.parentNode.insertBefore(M(e),b.nextSibling):this.append(e);return this},replaceWith:function(e){b.parentNode.replaceChild(M(e),b);this.unbind();b=M(e);return this},remove:function(){this.unbind();var e=h.createElement("div");e.appendChild(b);b=e.innerHTML=null;return this},show:function(){this.computedCss("display")==="none"&&this.css("display",g);return this},hide:function(){if(this.computedCss("display")!=="none"){g=this.css("display");this.css("display","none")}return this},
outer:function(){var e=h.createElement("div");e.appendChild(b);return S(e.innerHTML)},hasVal:function(){return!!Fa[this.name]},isSingle:function(){return!!pa[this.name]},isInline:function(){return!!Ga[this.name]},isBlock:function(){return!!Ha[this.name]},contains:function(e){return ea(b,M(e))},parent:function(){return n(b.parentNode)},prev:function(){return n(b.previousSibling)},next:function(){return n(b.nextSibling)},each:function(e,f){function k(j){if(j=f?j.first:j.last)for(;j;){var l=f?j.next():
j.prev();if(e(j))return true;if(k(j))return;j=l}}f=f===v?true:f;k(this)},toString:function(){return this.type==3?b.nodeValue:this.outer()}};(function(e){for(var f=[],k=e.firstChild;k;){if(k.nodeType!=3||I(k.nodeValue)!=="")f.push(n(k));k=k.nextSibling}if(f.length>0){this.first=f[0];this.last=f[f.length-1]}else this.first=this.last=null;this.children=f;f=-1;for(e=e;e;){f++;e=e.previousSibling}this.index=f}).call(d,b);return d}function ta(){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===
this.endOffset}function ua(){function c(f){for(var k=[];f;){k.push(f);f=f.parentNode}return k}for(var a=c(this.startContainer),b=c(this.endContainer),d=0,h=a.length,i=b.length,g,e;++d;){g=a[h-d];e=b[i-d];if(!g||!e||g!==e)break}this.commonAncestorContainer=a[h-d+1]}function va(c){var a=F(c);c=F(c);a.startContainer=a.endContainer=this.startContainer;a.startOffset=a.endOffset=this.startOffset;c.startContainer=c.endContainer=this.endContainer;c.startOffset=c.endOffset=this.endOffset;if(a.compareBoundaryPoints(N,
c)==1){this.startContainer=this.endContainer;this.startOffset=this.endOffset}}function fa(c,a,b){function d(x,D,u){var G=x.nodeValue.length,L;if(a){L=x.cloneNode(true).splitText(D);L.splitText(u-D)}if(b){var o=x;if(D>0)o=x.splitText(D);u<G&&o.splitText(u-D);j.push(o)}return L}function h(x){return x==g&&x==f?d(x,e,k):x==g?d(x,e,x.nodeValue.length):x==f?d(x,0,k):d(x,0,x.nodeValue.length)}function i(x,D){for(var u=x.firstChild;u;){var G=F(c);G.selectNode(u);if(G.compareBoundaryPoints(O,l)>=0)return false;
var L=u.nextSibling;if(G.compareBoundaryPoints(P,l)>0){var o=u.nodeType;if(o==1)if(G.compareBoundaryPoints(N,l)>=0){a&&D.appendChild(u.cloneNode(true));b&&j.push(u)}else{var t;if(a){t=u.cloneNode(false);D.appendChild(t)}if(!i(u,t))return false}else if(o==3)(u=h(u))&&D.appendChild(u)}u=L}return true}var g=this.startContainer,e=this.startOffset,f=this.endContainer,k=this.endOffset,j=[],l=this;if(b){l=this.cloneRange();this.collapse(true);if(g.nodeType==3&&e===0){this.setStart(g.parentNode,0);this.setEnd(g.parentNode,
0)}}var w=c.createDocumentFragment(),r=l.commonAncestorContainer;if(r.nodeType==3)(r=h(r))&&w.appendChild(r);else i(r,w);r=0;for(var E=j.length;r<E;r++)n(j[r]).remove();return a?w:this}function wa(c,a){var b=c.parentElement().ownerDocument,d=F(b),h=c.duplicate();h.collapse(a);var i=h.parentElement(),g=i.childNodes;if(g.length===0){d.selectNode(i);return{node:d.startContainer,offset:d.startOffset}}b=b;var e=0,f=false,k=c.duplicate();k.moveToElementText(i);for(var j=0,l=g.length;j<l;j++){var w=g[j],
r=k.compareEndPoints("StartToStart",h);if(r>0)f=true;if(r===0)return{node:w.parentNode,offset:j};if(w.nodeType==1){r=c.duplicate();r.moveToElementText(w);k.setEndPoint("StartToEnd",r);if(f)e+=r.text.length;else e=0}else if(w.nodeType==3){k.moveStart("character",w.nodeValue.length);e+=w.nodeValue.length}f||(b=w)}if(!f&&b.nodeType==1){d.setStartAfter(i.lastChild);return{node:d.startContainer,offset:d.startOffset}}k=c.duplicate();k.moveToElementText(i);k.setEndPoint("StartToEnd",h);e-=k.text.length;
return{node:b,offset:e}}function Ia(c){var a;if(J){a=c.parentElement().ownerDocument;if(c.item){a=F(a);a.selectNode(c.item(0));return a}var b=wa(c,true);c=wa(c,false);a=F(a);a.setStart(b.node,b.offset);a.setEnd(c.node,c.offset)}else{b=c.startContainer;a=b.ownerDocument||b;a=F(a);a.setStart(b,c.startOffset);a.setEnd(c.endContainer,c.endOffset)}return a}function xa(c){var a=c.ownerDocument,b=0;for(c=c.previousSibling;c;){if(c.nodeType==1)if(n(c).isSingle())b+=1;else{var d=a.body.createTextRange();d.moveToElementText(c);
b+=d.text.length}else if(c.nodeType==3)b+=c.nodeValue.length;c=c.previousSibling}return b}function ya(c,a){var b=c.ownerDocument||c,d=b.body.createTextRange();if(b==c){d.collapse(true);return d}if(c.nodeType==1){var h=c.childNodes,i,g=false,e;if(a===0){i=h[0];h=true}else{i=h[a-1];h=false}if(!i){e=b.createTextNode(" ");c.appendChild(e);i=e;g=true}if(i.nodeName.toLowerCase()==="head"){if(a===1)h=true;if(a===2)h=false;d.collapse(h);return d}if(i.nodeType==1){d.moveToElementText(i);d.collapse(h)}else{d.moveToElementText(c);
g&&c.removeChild(e);b=xa(i);b=h?b:b+i.nodeValue.length;d.moveStart("character",b)}}else if(c.nodeType==3){d.moveToElementText(c.parentNode);d.moveStart("character",a+xa(c))}return d}function F(c){if(!c.nodeName)return c.get?c:Ia(c);return{startContainer:c,startOffset:0,endContainer:c,endOffset:0,collapsed:true,commonAncestorContainer:c,setStart:function(a,b){this.startContainer=a;this.startOffset=b;if(this.endContainer===c){this.endContainer=a;this.endOffset=b}va.call(this,c);ta.call(this);ua.call(this,
c);return this},setEnd:function(a,b){this.endContainer=a;this.endOffset=b;if(this.startContainer===c){this.startContainer=a;this.startOffset=b}va.call(this,c);ta.call(this);ua.call(this,c);return this},setStartBefore:function(a){return this.setStart(a.parentNode||c,n(a).index)},setStartAfter:function(a){return this.setStart(a.parentNode||c,n(a).index+1)},setEndBefore:function(a){return this.setEnd(a.parentNode||c,n(a).index)},setEndAfter:function(a){return this.setEnd(a.parentNode||c,n(a).index+1)},
selectNode:function(a){this.setStartBefore(a);this.setEndAfter(a);return this},selectNodeContents:function(a){var b=n(a);if(b.type==3||b.isSingle())this.selectNode(a);else if(b.children.length>0){this.setStartBefore(b.first.get());this.setEndAfter(b.last.get())}else{this.setStart(a,0);this.setEnd(a,0)}return this},collapse:function(a){a?this.setEnd(this.startContainer,this.startOffset):this.setStart(this.endContainer,this.endOffset);return this},compareBoundaryPoints:function(a,b){var d=this.get(),
h=b.get();if(c.createRange)return d.compareBoundaryPoints(a,h);else{var i={};i[N]="StartToStart";i[P]="EndToStart";i[V]="EndToEnd";i[O]="StartToEnd";d=d.compareEndPoints(i[a],h);if(d!==0)return d;var g,e,f,k;if(a===N||a===O){g=this.startContainer;f=this.startOffset}if(a===P||a===V){g=this.endContainer;f=this.endOffset}if(a===N||a===P){e=b.startContainer;k=b.startOffset}if(a===V||a===O){e=b.endContainer;k=b.endOffset}if(g===e){g=f-k;return g>0?1:g<0?-1:0}for(d=e;d&&d.parentNode!==g;)d=d.parentNode;
if(d)return n(d).index>=f?-1:1;for(d=g;d&&d.parentNode!==e;)d=d.parentNode;if(d)return n(d).index>=k?1:-1}},cloneRange:function(){var a=F(c);a.setStart(this.startContainer,this.startOffset);a.setEnd(this.endContainer,this.endOffset);return a},toString:function(){var a=this.get();return(c.createRange?a.toString():a.text).replace(/\r\n|\n|\r/g,"")},cloneContents:function(){return fa.call(this,c,true,false)},deleteContents:function(){return fa.call(this,c,false,true)},extractContents:function(){return fa.call(this,
c,true,true)},insertNode:function(a){var b=this.startContainer,d=this.startOffset,h=this.endContainer,i=this.endOffset,g,e,f,k,j=b==h,l=a.nodeName.toLowerCase()==="#document-fragment";if(h.nodeType==1&&i>0){f=h.childNodes[i-1];if(f.nodeType==3)if(j=b==f)k=f.nodeValue.length}if(b.nodeType==1)if(b.childNodes.length>0)g=b.childNodes[d];else e=b;else if(d===0)g=b;else if(d<b.length){g=b.splitText(d);if(j){k=k?k-d:this.endOffset-d;this.setEnd(g,k)}}else if(b.nextSibling)g=b.nextSibling;else e=b.parentNode;
g&&g.parentNode.insertBefore(a,g);e&&e.appendChild(a);if(l){a.firstChild&&this.setStartBefore(a.firstChild);if(this.collapsed){if(g)f=g.previousSibling;if(e)f=e.lastChild}}else{this.setStartBefore(a);if(this.collapsed)f=a}f&&this.setEndAfter(f);return this},surroundContents:function(a){a.appendChild(this.extractContents());return this.insertNode(a)},get:function(){var a=this.startContainer,b=this.startOffset,d=this.endContainer,h=this.endOffset,i;if(c.createRange){i=c.createRange();i.setStart(a,b);
i.setEnd(d,h)}else{i=c.body.createTextRange();i.setEndPoint("StartToStart",ya(a,b));i.setEndPoint("EndToStart",ya(d,h))}return i},html:function(){return n(this.cloneContents()).outer()}}}function za(c,a){var b="";try{b=c.queryCommandValue(a)}catch(d){}if(typeof b!=="string")b="";return b}function Aa(c){var a=c.parentWindow||c.defaultView;return a.getSelection?a.getSelection():c.selection}function W(c,a){var b=a.startContainer,d=a.endContainer,h=b.ownerDocument||b,i=h.parentWindow||h.defaultView;if(J&&
b.nodeType==1&&a.collapsed){b=h.createTextNode(" ");d.appendChild(b);h=h.body.createTextRange();h.moveToElementText(d);h.collapse(false);h.select();d.removeChild(b)}else{h=a.get();if(J)h.select();else{c.removeAllRanges();c.addRange(h)}}i.focus()}function Ba(c,a,b){c=n(c);var d,h={};b=b||c.name;if(c.type!==1)return false;z(a,function(g,e){d=g.split(",");for(var f=0,k=d.length,j=d[f];f<k;f++)h[j]=e});if(h[b]){d=h[b].split(",");a=0;b=d.length;for(var i=d[a];a<b;a++){if(i.charAt(0)==="."&&c.css(i.substr(1))!==
"")return true;if(i.charAt(0)!=="."&&c.attr(i)!=="")return true}}return false}function X(c,a){for(var b=c.commonAncestorContainer;b;){if(Ba(b,a,"*"))return b;if(Ba(b,a))return b;b=b.parentNode}return null}function ga(c){var a,b,d;if(c.nodeName){b=c.ownerDocument||c;a=Aa(b);try{d=a.rangeCount>0?a.getRangeAt(0):a.createRange()}catch(h){}c=d||b;if(J&&(!d||d.parentElement().ownerDocument!==b))return null}else{d=c.startContainer;b=d.ownerDocument||d;a=Aa(b);d=c.get()}var i=F(c);return{wrap:function(g){var e=
n(g,b),f;if(!e.isInline()){f=e.clone(false);i.surroundContents(f.get());W(a,i);return this}if(i.collapsed){f=e.clone(false);i.insertNode(f.get());i.selectNodeContents(f.get());W(a,i);return this}g=i.extractContents();var k=e.name;n(g).each(function(j){if(j.type==3&&j.parent().name!==k){f=e.clone(false);f.append(j.clone(true));j.replaceWith(f)}else if(j.name===k){z(e.attr(),function(l,w){l!=="style"&&j.attr(l,w)});z(e.css(),function(l,w){j.css(l,w)})}});i.insertNode(g);W(a,i);return this},remove:function(){if(i.collapsed)return this;
var g=i.extractContents(),e=wrapper.name;n(g).each(function(f){if(f.type==3&&f.parent().name!==e){var k=wrapper.clone(false);k.append(f.clone(true));f.replaceWith(k)}else if(f.name===e){z(wrapper.attr(),function(j,l){j!=="style"&&f.attr(j,l)});z(wrapper.css(),function(j,l){f.css(j,l)})}});i.insertNode(g);W(a,i);return this},exec:function(g,e){return this[g.toLowerCase()](e)},state:function(g){var e=false;try{e=b.queryCommandState(g)}catch(f){}return e},val:function(g){g=g.toLowerCase();var e="";if(g===
"fontfamily"||g==="fontname"){e=za(b,"fontname");e=e.replace(/['"]/g,"");return e.toLowerCase()}if(g==="formatblock"){e=za(b,g);if(e==="")if(g=X(i,{"h1,h2,h3,h4,h5,h6,p,div,pre,address":"*"}))e=g.nodeName;if(e==="Normal")e="p";return e.toLowerCase()}if(g==="fontsize"){if(g=X(i,{"*":".font-size"}))e=n(g).css("font-size");return e.toLowerCase()}if(g==="forecolor"){if(g=X(i,{"*":".color"}))e=n(g).css("color");e=Q(e);if(e==="")e="default";return e.toLowerCase()}if(g==="hilitecolor"){X(i,{"*":".background-color"});
e=Q(e);if(e==="")e="default";return e.toLowerCase()}return e},bold:function(){return this.wrap("<strong></strong>")},italic:function(){return this.wrap("<em></em>")},forecolor:function(g){return this.wrap('<span style="color:'+g+';"></span>')},hilitecolor:function(g){return this.wrap('<span style="background-color:'+g+';"></span>')},fontsize:function(g){return this.wrap('<span style="font-size:'+g+';"></span>')},fontname:function(g){return this.fontfamily(g)},fontfamily:function(g){return this.wrap('<span style="font-family:'+
g+';"></span>')},removeformat:function(){var g={"*":"class,style"},e=_INLINE_TAGS.split(",");z(e,function(f,k){g[k]="*"});this.remove(g);return this}}}function Ja(c){return c.contentDocument||c.contentWindow.document}function Ka(c,a){var b=['<!doctype html><html><head><meta charset="utf-8" /><title>KindEditor</title>'];if(a){if(typeof a=="string"&&!/\{[\s\S]*\}/g.test(a))a=[a];aa(a)?z(a,function(d,h){h!==""&&b.push('<link href="'+h+'" rel="stylesheet" />')}):b.push("<style>"+a+"</style>")}b.push("</head><body "+
(c?'class="'+c+'"':"")+"></body></html>");return b.join("")}function Y(c){var a=this.doc.body;if(c===v)return n(a).html();else{n(a).html(c);return this}}function Z(c){var a=this.textarea;if(c===v)return a.val();else{a.val(c);return this}}var H=navigator.userAgent.toLowerCase(),J=H.indexOf("msie")>-1&&H.indexOf("opera")==-1,ha=H.indexOf("gecko")>-1&&H.indexOf("khtml")==-1,La=H.indexOf("applewebkit")>-1,Ma=H.indexOf("opera")>-1,U=(H=/(?:msie|firefox|webkit|opera)[\/:\s](\d+)/.exec(H))?H[1]:"0",Ga=K("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),
Ha=K("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),pa=K("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");K("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");K("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected");var Fa=K("input,button,textarea,select"),A={IE:J,GECKO:ha,
WEBKIT:La,OPERA:Ma,VERSION:U,each:z,isArray:aa,inArray:ba,inString:ia,trim:I,toHex:Q,toMap:K},Ea="altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,data,detail,eventPhase,fromElement,handler,keyCode,layerX,layerY,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which".split(","),da=[],q={};A.bind=ja;A.unbind=ka;A.fire=la;A.formatHtml=
S;A.query=ra;A.queryAll=qa;A.node=n;var N=0,P=1,V=2,O=3;A.range=F;A.START_TO_START=N;A.START_TO_END=P;A.END_TO_END=V;A.END_TO_START=O;A.cmd=ga;A.edit=function(c,a){function b(e){return d.hasVal()?d.val(e):d.html(e)}var d=n(c),h=a.designMode===v?true:a.designMode,i=a.bodyClass,g=a.css;return{width:a.width||0,height:a.height||0,html:function(e){this.val(e)},val:function(e){return h?Y.call(this,e):Z.call(this,e)},create:function(){function e(){var E=ga(r);if(E)j.cmd=E}function f(){z("formatblock,fontfamily,fontsize,forecolor,hilitecolor".split(","),
function(){j.cmd.val(this)})}function k(){var E="justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,indent,outdent,subscript,superscript,bold,italic,underline,strikethrough".split(",");z(E,function(){j.cmd.state(this)})}var j=this;if(j.iframe)return j;var l=n('<iframe class="ke-iframe" frameborder="0"></iframe>');l.css({display:"block",width:j.width,height:j.height});var w=n('<textarea class="ke-textarea"></textarea>');w.css({display:"block",width:j.width,height:j.height});
h?w.hide():l.hide();d.before(l);d.before(w);d.hide();var r=Ja(l.get());r.open();r.write(Ka(i,g));r.close();j.iframe=l;j.textarea=w;j.doc=r;h?Y.call(j,b()):Z.call(j,b());j.cmd=ga(r);j.oninput(e);n(r).bind("mouseup",e);n(document).bind("mousedown",e);j.oninput(f);n(r).bind("click",f);j.oninput(k);n(r).bind("click",k);return j},remove:function(){var e=this.iframe,f=this.textarea,k=this.doc;if(!e)return this;n(k).unbind();n(k.body).unbind();n(document).unbind();d.show();b(this.val());e.remove();f.remove();
this.iframe=this.textarea=null;return this},toggle:function(e){var f=this.iframe,k=this.textarea;if(!f)return this;if(e===v?!h:e){if(!h){k.hide();Y.call(this,Z.call(this));f.show();h=true}}else if(h){f.hide();Z.call(this,Y.call(this));k.show();h=false}return this},toDesign:function(){return this.toggle(true)},toSource:function(){return this.toggle(false)},focus:function(){this.iframe&&h&&this.iframe.contentWindow.focus();return this},oninput:function(e){function f(l){setTimeout(function(){e(l)},1)}
var k=this.doc,j=k.body;n(k).bind("keyup",function(l){if(!l.ctrlKey&&!l.altKey&&(l.keyCode<16||l.keyCode>18)&&l.keyCode!=116){e(l);l.stop()}});n(j).bind("paste",f);n(j).bind("cut",f);return this}}};ha=A;A=function(){};z(ha,function(c,a){A[c]=a});if($.K===v)$.K=A;$.KindEditor=A})(window);
