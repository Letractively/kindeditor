(function(fa,x){function ga(a){return Object.prototype.toString.call(a)==="[object Array]"}function ha(a,b){for(var c=0,d=b.length;c<d;c++)if(a===b[c])return c;return-1}function v(a,b){if(ga(a))for(var c=0,d=a.length;c<d;c++){if(b.call(a[c],c,a[c])===false)break}else for(c in a)if(a.hasOwnProperty(c))if(b.call(a[c],c,a[c])===false)break}function J(a){return a.replace(/^\s+|\s+$/g,"")}function ra(a,b,c){c=c===x?",":c;return(c+b+c).indexOf(c+a+c)>=0}function Z(a){function b(c){c=parseInt(c,10).toString(16).toUpperCase();
return c.length>1?c:"0"+c}return a.replace(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/ig,function(c,d,e,f){return"#"+b(d)+b(e)+b(f)})}function G(a,b){b=b===x?",":b;var c={},d=a.split(b),e;v(d,function(f,g){if(e=/^(\d+)\.\.(\d+)$/.exec(g))for(var h=parseInt(e[1],10);h<=parseInt(e[2],10);h++)c[h.toString()]=true;else c[g]=true});return c}function Wa(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent&&a.attachEvent("on"+b,c)}function $(a,b,c){if(a.removeEventListener)a.removeEventListener(b,
c,false);else a.detachEvent&&a.detachEvent("on"+b,c)}function Xa(a,b){if(b){var c={},d=a.ownerDocument||a.document||a;v(Ya,function(f,g){c[g]=b[g]});if(!c.target)c.target=c.srcElement||d;if(c.target.nodeType===3)c.target=c.target.parentNode;if(!c.relatedTarget&&c.fromElement)c.relatedTarget=c.fromElement===c.target?c.toElement:c.fromElement;if(c.pageX==null&&c.clientX!=null){var e=d.documentElement;d=d.body;c.pageX=c.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||d&&d.clientLeft||
0);c.pageY=c.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0)}if(!c.which&&(c.charCode||c.charCode===0?c.charCode:c.keyCode))c.which=c.charCode||c.keyCode;if(!c.metaKey&&c.ctrlKey)c.metaKey=c.ctrlKey;if(!c.which&&c.button!==x)c.which=c.button&1?1:c.button&2?3:c.button&4?2:0;switch(c.which){case 186:c.which=59;break;case 187:case 107:case 43:c.which=61;break;case 189:case 45:c.which=109;break;case 42:c.which=106;break;case 47:c.which=111;break;case 78:c.which=110;break}if(c.which>=
96&&c.which<=105)c.which-=48;c.preventDefault=function(){b.preventDefault&&b.preventDefault();b.returnValue=false};c.stopPropagation=function(){b.stopPropagation&&b.stopPropagation();b.cancelBubble=true};c.stop=function(){this.preventDefault();this.stopPropagation()};return c}}function ia(a){var b=ha(a,ja);if(b<0){b=ja.length;ja.push(a);s[b]={}}return b}function P(a,b,c){if(b.indexOf(",")>=0)v(b.split(","),function(){P(a,this,c)});else{var d=ia(a);if(s[d][b]!==x&&s[d][b].length>0){v(s[d][b],function(e,
f){f===x&&s[d][b].splice(e,1)});$(a,b,s[d][b][0])}else s[d][b]=[];if(s[d][b].length===0)s[d][b][0]=function(e){v(s[d][b],function(f,g){f>0&&g&&g.call(a,Xa(a,e))})};ha(c,s[d][b])<0&&s[d][b].push(c);Wa(a,b,s[d][b][0])}}function Q(a,b,c){if(b&&b.indexOf(",")>=0)v(b.split(","),function(){Q(a,this,c)});else{var d=ia(a);if(b===x){if(d in s){v(s[d],function(g,h){$(a,g,h[0])});s[d]={}}}else if(s[d][b]!==x&&s[d][b].length>0)if(c===x){$(a,b,s[d][b][0]);s[d][b]=[]}else{for(var e=0,f=s[d][b].length;e<f;e++)s[d][b][e]===
c&&delete s[d][b][e];if(s[d][b].length==2&&s[d][b][1]===x){$(a,b,s[d][b][0]);s[d][b]=[]}}}}function ka(a,b){if(b.indexOf(",")>=0)v(b.split(","),function(){ka(a,this)});else{var c=ia(a);s[c][b]!==x&&s[c][b].length>0&&s[c][b][0]()}}function sa(a,b){function c(){if(!f){f=true;a.call(b)}Q(b,"DOMContentLoaded");Q(b,"readystatechange");Q(e,"load")}function d(){if(!f){try{b.documentElement.doScroll("left")}catch(g){e.setTimeout(d,0);return}c()}}b=b||document;var e=b.parentWindow||b.defaultView,f=false;if(b.addEventListener)P(b,
"DOMContentLoaded",c);else if(b.attachEvent){P(b,"readystatechange",function(){b.readyState==="complete"&&c()});b.documentElement.doScroll&&e.frameElement===x&&d()}P(e,"load",c)}function ta(a){for(var b={},c=/\s*([\w\-]+)\s*:([^;]*)(;|$)/g,d;d=c.exec(a);){var e=J(d[1].toLowerCase());d=J(Z(d[2]));b[e]=d}return b}function ua(a){for(var b={},c=/\s+(?:([\w-:]+)|(?:([\w-:]+)=([^\s"'<>]+))|(?:([\w-:]+)="([^"]*)")|(?:([\w-:]+)='([^']*)'))(?=(?:\s|\/|>)+)/g,d;d=c.exec(a);)b[d[1]||d[2]||d[4]||d[6]]=(d[2]?
d[3]:d[4]?d[5]:d[7])||"";return b}function va(a){var b="";v(ta(a),function(c,d){b+=c+":"+d+";"});return b}function aa(a){a=a.replace(/((?:[\r\n])*)<(\/)?([\w-:]+)(\s*(?:[\w-:]+)(?:=(?:"[^"]*"|'[^']*'|[^\s"'<>]*))?)*\s*(\/)?>((?:[\r\n])*)/g,function(b,c,d,e,f,g,h){b=c||"";d=d||"";e=e.toLowerCase();f=f||"";g=g?" "+g:"";h=h||"";if(g===""&&wa[e])g=" /";if(h)h="";if(e!=="script"&&e!=="style")b="";if(f!==""){f=f.replace(/\s*([\w-:]+)=([^\s"'<>]+|"[^"]*"|'[^']*')/g,function(i,q,m){i=q.toLowerCase();m=m||
"";if(m==="")m='""';else{if(i==="style"){m=m.substr(1,m.length-2);m=va(m);if(m==="")return"";m='"'+m+'"'}/^['"]/.test(m)||(m='"'+m+'"')}return" "+i+"="+m+" "});f=J(f);if(f=f.replace(/\s+/g," "))f=" "+f;return b+"<"+d+e+f+g+">"+h}else return b+"<"+d+e+g+">"+h});return J(a)}function la(a,b){var c=a.ownerDocument||a,d=b.ownerDocument||b;if(c!==d)return false;if(b===d)return false;if(a===c)return true;if(a.nodeType===3)return false;if(b.nodeType===3){b=b.parentNode;if(!b)return false;if(a===b)return true}if(a.compareDocumentPosition)return!!(a.compareDocumentPosition(b)&
16);return a!==b&&a.contains(b)}function ba(a,b){b=b.toLowerCase();var c=null;if(H&&U<8){var d=a.ownerDocument.createElement("div");d.appendChild(a.cloneNode(false));d=ua(d.innerHTML.toLowerCase());if(b in d)c=d[b]}else c=a.getAttribute(b,2);if(b==="style"&&c!==null)c=va(c);return c}function xa(a,b){function c(p){if(typeof p!="string")return p;return p.replace(/([^\w\-])/g,"\\$1")}function d(p,z){return p==="*"||p.toLowerCase()===c(z.toLowerCase())}function e(p,z,r){var l=[];(p=(r.ownerDocument||
r).getElementById(p.replace(/\\/g,"")))&&d(z,p.nodeName)&&la(r,p)&&l.push(p);return l}function f(p,z,r){var l=r.ownerDocument||r,t=[],A,C,D;if(r.getElementsByClassName){l=r.getElementsByClassName(p.replace(/\\/g,""));A=0;for(C=l.length;A<C;A++){D=l[A];d(z,D.nodeName)&&t.push(D)}}else if(l.querySelectorAll){l=l.querySelectorAll((r.nodeName!=="#document"?r.nodeName+" ":"")+z+"."+p);A=0;for(C=l.length;A<C;A++){D=l[A];la(r,D)&&t.push(D)}}else{l=r.getElementsByTagName(z);A=0;for(C=l.length;A<C;A++){D=
l[A];if(D.nodeType==1)(z=D.className)&&(" "+z+" ").indexOf(" "+p+" ")>-1&&t.push(D)}}return t}function g(p,z,r,l){var t=[];r=l.getElementsByTagName(r);l=0;for(var A=r.length,C;l<A;l++){C=r[l];if(C.nodeType==1)if(z===null)ba(C,p)!==null&&t.push(C);else z===c(ba(C,p))&&t.push(C)}return t}function h(p,z){var r=[],l,t=(l=/^((?:\\.|[^.#\s\[<>])+)/.exec(p))?l[1]:"*";if(l=/#((?:[\w\-]|\\.)+)$/.exec(p))r=e(l[1],t,z);else if(l=/\.((?:[\w\-]|\\.)+)$/.exec(p))r=f(l[1],t,z);else if(l=/\[((?:[\w\-]|\\.)+)\]/.exec(p))r=
g(l[1].toLowerCase(),null,t,z);else if(l=/\[((?:[\w\-]|\\.)+)\s*=\s*['"]?((?:\\.|[^'"]+)+)['"]?\]/.exec(p)){r=l[1].toLowerCase();l=l[2];if(r==="id")t=e(l,t,z);else{if(r==="class")t=f(l,t,z);else{if(r==="name"){r=[];l=z.getElementsByName(l.replace(/\\/g,""));for(var A=0,C=l.length,D;A<C;A++){D=l[A];d(t,D.nodeName)&&D.getAttributeNode("name")&&r.push(D)}t=r}else t=g(r,l,t,z);t=t}t=t}r=t}else{t=z.getElementsByTagName(t);l=0;for(A=t.length;l<A;l++){C=t[l];C.nodeType==1&&r.push(C)}}return r}b=b||document;
for(var i=[],q,m=/((?:\\.|[^\s>])+|[\s>])/g;q=m.exec(a);)q[1]!==" "&&i.push(q[1]);var o=[];if(i.length==1)return h(i[0],b);q=false;m=0;for(var n=i.length;m<n;m++){var w=i[m];if(w===">")q=true;else{if(m>0){var E=[],B=0,u=o.length;for(o=o[B];B<u;B++){var k=h(w,o),F=0,K=k.length;for(k=k[F];F<K;F++)if(q)o===k.parentNode&&E.push(k);else E.push(k)}o=E}else o=h(w,b);if(o.length===0)return[]}}return o}function ya(a,b){var c=xa(a,b);return c.length>0?c[0]:null}function V(a){return a.get?a.get():a}function za(a){var b=
a.split("-");a="";v(b,function(c,d){a+=c>0?d.charAt(0).toUpperCase()+d.substr(1):d});return a}function L(a){this.node=a;this.doc=this.node.ownerDocument||this.node;this.name=this.node.nodeName.toLowerCase();this.type=this.node.nodeType;this.win=this.doc.parentWindow||this.doc.defaultView;this._prevDisplay=""}function j(a,b){function c(e){if(!e)return null;return new L(e)}if(typeof a==="string"){if(/<.+>/.test(a)){var d=(b?b.ownerDocument||b:document).createElement("div");if(d.nodeType==1)d.innerHTML=
""+a;return c(d.firstChild)}return c(ya(a,b))}if(a&&a.get)return a;return c(a)}function Aa(){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset}function Ba(){function a(i){for(var q=[];i;){q.push(i);i=i.parentNode}return q}for(var b=a(this.startContainer),c=a(this.endContainer),d=0,e=b.length,f=c.length,g,h;++d;){g=b[e-d];h=c[f-d];if(!g||!h||g!==h)break}this.commonAncestorContainer=b[e-d+1]}function ma(a,b){function c(B,u,k){var F=B.nodeValue.length,K;if(a){K=
B.cloneNode(true).splitText(u);K.splitText(k-u)}if(b){var p=B;if(u>0)p=B.splitText(u);k<F&&p.splitText(k-u);q.push(p)}return K}function d(B,u){var k;if(B.nodeType==3){k=c(B,g,i);a&&u.appendChild(k);return false}k=B.firstChild;for(var F,K;k;){F=new M(e);F.selectNode(k);if(F.compareBoundaryPoints(N,m)>=0)return false;K=k.nextSibling;if(F.compareBoundaryPoints(R,m)>0)if(k.nodeType==1)if(F.compareBoundaryPoints(S,m)>=0&&F.compareBoundaryPoints(W,m)<=0){a&&u.appendChild(k.cloneNode(true));b&&q.push(k)}else{var p;
if(a){p=k.cloneNode(false);u.appendChild(p)}if(d(k,p)===false)return false}else if(k.nodeType==3){k=k==f&&k==h?c(k,g,i):k==f?c(k,g,k.nodeValue.length):k==h?c(k,0,i):c(k,0,k.nodeValue.length);a&&u.appendChild(k)}k=K}}var e=this.doc,f=this.startContainer,g=this.startOffset,h=this.endContainer,i=this.endOffset,q=[],m=this;if(b){m=this.cloneRange();f.nodeType==3&&g===0&&this.setStart(f.parentNode,0);this.collapse(true)}var o=e.createDocumentFragment();d(m.commonAncestorContainer,o);for(var n=0,w=q.length;n<
w;n++){var E=q[n];E.parentNode&&E.parentNode.removeChild(E)}return a?o:this}function Ca(a,b){var c=a.parentElement().ownerDocument,d=a.duplicate();d.collapse(b);var e=d.parentElement(),f=e.childNodes;if(f.length===0)return{node:e.parentNode,offset:j(e).index()};c=c;var g=0,h=false,i=a.duplicate();i.moveToElementText(e);for(var q=0,m=f.length;q<m;q++){var o=f[q],n=i.compareEndPoints("StartToStart",d);if(n>0)h=true;if(n===0)return{node:o.parentNode,offset:q};if(o.nodeType==1){n=a.duplicate();n.moveToElementText(o);
i.setEndPoint("StartToEnd",n);if(h)g+=n.text.length;else g=0}else if(o.nodeType==3){i.moveStart("character",o.nodeValue.length);g+=o.nodeValue.length}h||(c=o)}if(!h&&c.nodeType==1)return{node:e,offset:j(e.lastChild).index()+1};i=a.duplicate();i.moveToElementText(e);i.setEndPoint("StartToEnd",d);g-=i.text.length;return{node:c,offset:g}}function Da(a){var b=a.ownerDocument,c=0;for(a=a.previousSibling;a;){if(a.nodeType==1)if(j(a).isSingle())c+=1;else{var d=b.body.createTextRange();d.moveToElementText(a);
c+=d.text.length}else if(a.nodeType==3)c+=a.nodeValue.length;a=a.previousSibling}return c}function Ea(a,b){var c=a.ownerDocument||a,d=c.body.createTextRange();if(c==a){d.collapse(true);return d}if(a.nodeType==1){var e=a.childNodes,f,g=false,h;if(b===0){f=e[0];e=true}else{f=e[b-1];e=false}if(!f){h=c.createTextNode(" ");a.appendChild(h);f=h;g=true}if(f.nodeName.toLowerCase()==="head"){if(b===1)e=true;if(b===2)e=false;d.collapse(e);return d}if(f.nodeType==1){d.moveToElementText(f);d.collapse(e)}else{d.moveToElementText(a);
g&&a.removeChild(h);c=Da(f);c=e?c:c+f.nodeValue.length;d.moveStart("character",c)}}else if(a.nodeType==3){d.moveToElementText(a.parentNode);d.moveStart("character",b+Da(a))}return d}function M(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this.collapsed=true;this.doc=this.commonAncestorContainer=a}function X(a){if(!a.nodeName){if(a.get)a=a;else a:{var b;if(H){b=a.parentElement().ownerDocument;if(a.item){b=new M(b);b.selectNode(a.item(0));a=b;break a}var c=Ca(a,true);
a=Ca(a,false);b=new M(b);b.setStart(c.node,c.offset);b.setEnd(a.node,a.offset)}else{c=a.startContainer;b=c.ownerDocument||c;b=new M(b);b.setStart(c,a.startOffset);b.setEnd(a.endContainer,a.endOffset)}a=b}return a}return new M(a)}function Fa(a,b){var c="";try{c=a.queryCommandValue(b)}catch(d){}if(typeof c!=="string")c="";return c}function Ga(a){var b=a.parentWindow||a.defaultView;return b.getSelection?b.getSelection():a.selection}function Ha(a){var b=Ga(a),c;try{c=b.rangeCount>0?b.getRangeAt(0):b.createRange()}catch(d){}c=
c||a;if(H&&(!c||c.parentElement().ownerDocument!==a))return null;return c}function Ia(a){var b={},c,d;v(a,function(e,f){c=e.split(",");for(var g=0,h=c.length;g<h;g++){d=c[g];b[d]=f}});return b}function T(a,b,c){c=c||a.name;if(a.type!==1)return false;b=Ia(b);var d,e;if(b[c]){c=b[c].split(",");for(var f=0,g=c.length;f<g;f++){b=c[f];if(b==="*")return true;d=/^(\.?)([^=]+)(?:=([^=]+))?$/.exec(b);e=d[1]?"css":"attr";b=d[2];d=d[3]||"";if(d===""&&a[e](b)!=="")return true;if(d!==""&&a[e](b)===d)return true}}return false}
function Ja(a,b,c){c=c||a.name;if(a.type===1){b=Ia(b);if(b[c]){c=b[c].split(",");allFlag=false;for(var d=0,e=c.length;d<e;d++){b=c[d];if(b==="*"){allFlag=true;break}var f=/^(\.?)([^=]+)(?:=([^=]+))?$/.exec(b);b=f[2];f[1]?a.css(b,""):a.removeAttr(b)}if(allFlag){if(a.first())for(c=a.first();c;){b=c.next();a.before(c);c=b}a.remove()}}}}function O(a){for(a=a;a.first();)a=a.first();return a}function Ka(a,b){a=a.clone(true);for(var c=O(a),d=a,e=false;b;){for(;d;){if(d.name===b.name){Za(d,b.attr(),b.css());
e=true}d=d.first()}e||c.append(b.clone(false));e=false;b=b.first()}return a}function Za(a,b,c){v(b,function(d,e){d!=="style"&&a.attr(d,e)});v(c,function(d,e){a.css(d,e)})}function Y(a,b){var c=a.endContainer,d=a.endOffset;for(d=c=j(c.nodeType==3||d===0?c:c.childNodes[d-1]);d&&(d=d.firstChild)&&d.childNodes.length==1;)if(T(d,b,"*")||T(d,b))return d;for(;c;){if(T(c,b,"*")||T(c,b))return c;c=c.parent()}return null}function na(a){var b=a.doc;this.doc=b;this.win=b.parentWindow||b.defaultView;this.sel=
Ga(b);this.range=a;this._preremove=this._preformat=null}function La(a){if(a.nodeName){var b=a.ownerDocument||a,c=Ha(b),d=new na(X(c||b));d.onchange(function(){if(c=Ha(b))d.range=X(c)});d.oninput(function(){d._applyPreformat()});d.oncursormove(function(){d._preformat=null;d._preremove=null});return d}return new na(a)}function $a(a,b){var c=['<!doctype html><html><head><meta charset="utf-8" /><title>KindEditor</title>'];if(b){if(typeof b=="string"&&!/\{[\s\S]*\}/g.test(b))b=[b];ga(b)?v(b,function(d,
e){e!==""&&c.push('<link href="'+e+'" rel="stylesheet" />')}):c.push("<style>"+b+"</style>")}c.push("</head><body "+(a?'class="'+a+'"':"")+"></body></html>");return c.join("")}function ca(a){var b=this.doc.body;if(a===x)return j(b).html();else{j(b).html(a);return this}}function da(a){var b=this.textarea;if(a===x)return b.val();else{b.val(a);return this}}function oa(a,b){return a.hasVal()?a.val(b):a.html(b)}function Ma(a){this.srcElement=j(a.srcElement);this.width=a.width||0;this.height=a.height||
0;this.designMode=a.designMode===x?true:a.designMode;this.bodyClass=a.bodyClass;this.cssData=a.cssData}function Na(a){return new Ma(a)}function Oa(a){this.width=a.width||0;this.height=a.height||0;this.items=[];this.itemNodes=[]}function Pa(a){return new Oa(a)}function ea(a,b){if(b===x)return Qa[a];Qa[a]=b}function Ra(a){var b=this;v(a,function(d){b[d]=a[d]});v(ab,function(d,e){if(b[d]===x)b[d]=e});var c=j(b.srcElement);if(!b.width)b.width=c.css("width")||(c.offsetWidth||b.minWidth)+"px";if(!b.height)b.height=
c.css("height")||(c.offsetHeight||b.minHeight)+"px";b.srcElement=c}function Sa(a,b){b||(b={});if(!b.srcElement)b.srcElement=j("#"+a)||j("[name="+a+"]");var c=(new Ra(b)).create();bb.push(c);return c}var I=navigator.userAgent.toLowerCase(),H=I.indexOf("msie")>-1&&I.indexOf("opera")==-1,pa=I.indexOf("gecko")>-1&&I.indexOf("khtml")==-1,cb=I.indexOf("applewebkit")>-1,db=I.indexOf("opera")>-1,U=(I=/(?:msie|firefox|webkit|opera)[\/:\s](\d+)/.exec(I))?I[1]:"0",Ta=G("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),
eb=G("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),wa=G("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");G("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");G("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected");var fb=G("input,button,textarea,select"),y={IE:H,GECKO:pa,
WEBKIT:cb,OPERA:db,VERSION:U,each:v,isArray:ga,inArray:ha,inString:ra,trim:J,toHex:Z,toMap:G},Ya="altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,data,detail,eventPhase,fromElement,handler,keyCode,layerX,layerY,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which".split(","),ja=[],s={};y.bind=P;y.unbind=Q;y.fire=ka;y.ready=sa;y.formatHtml=
aa;y.query=ya;y.queryAll=xa;L.prototype={bind:function(a,b){var c=this;P(c.node,a,function(d){b.call(c,d)});return c},unbind:function(a,b){var c=this;Q(c.node,a,function(d){b.call(c,d)});return c},fire:function(a){ka(this.node,a);return this},hasAttr:function(a){return ba(this.node,a)},attr:function(a,b){var c=this,d=c.node;if(a===x)return ua(c.outer());if(typeof a==="object"){v(a,function(e,f){c.attr(e,f)});return c}if(b===x){b=ba(d,a);return b===null?"":b}if(H&&U<8&&a.toLowerCase()=="class")a="className";
d.setAttribute(a,""+b);return c},removeAttr:function(a){if(H&&U<8&&a.toLowerCase()=="class")a="className";this.attr(a,"");this.node.removeAttribute(a);return this},get:function(){return this.node},hasClass:function(a){return ra(a,this.node.className," ")},addClass:function(a){var b=this.node;if(!this.hasClass(a))b.className=J(b.className+" "+a);return this},removeClass:function(a){var b=this.node;if(this.hasClass(a))b.className=J(b.className.replace(new RegExp("\\s*"+a+"\\s*"),""));return this},html:function(a){var b=
this.node;if(a===x)return aa(b.innerHTML);else{a=aa(a);if(b.nodeType==1)b.innerHTML=""+a;return this}},val:function(a){var b=this.node;if(a===x)return this.hasVal()?b.value:this.attr("value");else{if(this.hasVal())b.value=a;else this.attr("value",a);return this}},css:function(a,b){var c=this,d=c.node;if(a===x)return ta(c.attr("style"));if(typeof a==="object"){v(a,function(e,f){c.css(e,f)});return c}if(b===x)return d.style[a]||c.computedCss(a)||"";d.style[za(a)]=b;return c},computedCss:function(a){var b=
this.node,c=za(a),d="";if(this.win.getComputedStyle){d=this.win.getComputedStyle(b,null);d=d[c]||d.getPropertyValue(a)||b.style[c]}else if(b.currentStyle)d=b.currentStyle[c]||b.style[c];return d},clone:function(a){return new L(this.node.cloneNode(a))},append:function(a){this.node.appendChild(V(a));return this},before:function(a){var b=this.node;b.parentNode.insertBefore(V(a),b);return this},after:function(a){var b=this.node;b.nextSibling?b.parentNode.insertBefore(V(a),b.nextSibling):this.append(a);
return this},replaceWith:function(a){a=V(a);var b=this.node;b.parentNode.replaceChild(a,b);this.unbind();this.node=a;return this},remove:function(){var a=this.node;this.unbind();a.parentNode&&a.parentNode.removeChild(a);this.node=null;return this},show:function(){this.computedCss("display")==="none"&&this.css("display",this._prevDisplay);return this},hide:function(){if(this.computedCss("display")!=="none"){this._prevDisplay=this.css("display");this.css("display","none")}return this},outer:function(){var a=
this.doc.createElement("div");a.appendChild(this.node.cloneNode(true));return aa(a.innerHTML)},hasVal:function(){return!!fb[this.name]},isSingle:function(){return!!wa[this.name]},isInline:function(){return!!Ta[this.name]},isBlock:function(){return!!eb[this.name]},contains:function(a){return la(this.node,V(a))},parent:function(){var a=this.node.parentNode;return a?new L(a):null},children:function(){for(var a=[],b=this.node.firstChild;b;){if(b.nodeType!=3||J(b.nodeValue)!=="")a.push(new L(b));b=b.nextSibling}return a},
first:function(){var a=this.children();return a.length>0?a[0]:null},last:function(){var a=this.children();return a.length>0?a[a.length-1]:null},index:function(){for(var a=-1,b=this.node;b;){a++;b=b.previousSibling}return a},prev:function(){var a=this.node.previousSibling;return a?new L(a):null},next:function(){var a=this.node.nextSibling;return a?new L(a):null},each:function(a,b){function c(d){for(d=b?d.firstChild:d.lastChild;d;){var e=b?d.nextSibling:d.previousSibling;if(a(new L(d))===false)return false;
if(c(d)===false)return false;d=e}}b=b===x?true:b;c(this.node)},toString:function(){return this.type==3?this.node.nodeValue:this.outer()}};y.node=j;var S=0,R=1,W=2,N=3;M.prototype={setStart:function(a,b){var c=this.doc;this.startContainer=a;this.startOffset=b;if(this.endContainer===c){this.endContainer=a;this.endOffset=b}Aa.call(this);Ba.call(this);return this},setEnd:function(a,b){var c=this.doc;this.endContainer=a;this.endOffset=b;if(this.startContainer===c){this.startContainer=a;this.startOffset=
b}Aa.call(this);Ba.call(this);return this},setStartBefore:function(a){return this.setStart(a.parentNode||this.doc,j(a).index())},setStartAfter:function(a){return this.setStart(a.parentNode||this.doc,j(a).index()+1)},setEndBefore:function(a){return this.setEnd(a.parentNode||this.doc,j(a).index())},setEndAfter:function(a){return this.setEnd(a.parentNode||this.doc,j(a).index()+1)},selectNode:function(a){return this.setStartBefore(a).setEndAfter(a)},selectNodeContents:function(a){var b=j(a);if(b.type==
3||b.isSingle())return this.selectNode(a);b=b.children();if(b.length>0)return this.setStartBefore(b[0].get()).setEndAfter(b[b.length-1].get());return this.setStart(a,0).setEnd(a,0)},collapse:function(a){if(a)return this.setEnd(this.startContainer,this.startOffset);return this.setStart(this.endContainer,this.endOffset)},compareBoundaryPoints:function(a,b){var c=this.get(),d=b.get();if(this.doc.createRange)return c.compareBoundaryPoints(a,d);else{var e={};e[S]="StartToStart";e[R]="EndToStart";e[W]=
"EndToEnd";e[N]="StartToEnd";c=c.compareEndPoints(e[a],d);if(c!==0)return c;var f,g,h,i;if(a===S||a===N){f=this.startContainer;h=this.startOffset}if(a===R||a===W){f=this.endContainer;h=this.endOffset}if(a===S||a===R){g=b.startContainer;i=b.startOffset}if(a===W||a===N){g=b.endContainer;i=b.endOffset}if(f===g){f=h-i;return f>0?1:f<0?-1:0}for(c=g;c&&c.parentNode!==f;)c=c.parentNode;if(c)return j(c).index()>=h?-1:1;for(c=f;c&&c.parentNode!==g;)c=c.parentNode;if(c)return j(c).index()>=i?1:-1}},cloneRange:function(){return(new M(this.doc)).setStart(this.startContainer,
this.startOffset).setEnd(this.endContainer,this.endOffset)},toString:function(){var a=this.get();return(this.doc.createRange?a.toString():a.text).replace(/\r\n|\n|\r/g,"")},cloneContents:function(){return ma.call(this,true,false)},deleteContents:function(){return ma.call(this,false,true)},extractContents:function(){return ma.call(this,true,true)},insertNode:function(a){var b=this.startContainer,c=this.startOffset,d=this.endContainer,e=this.endOffset,f,g,h,i=1;if(a.nodeName.toLowerCase()==="#document-fragment"){f=
a.firstChild;g=a.lastChild;i=a.childNodes.length}if(b.nodeType==1)if(h=b.childNodes[c]){b.insertBefore(a,h);if(b===d)e+=i}else b.appendChild(a);else if(b.nodeType==3)if(c===0){b.parentNode.insertBefore(a,b);if(b.parentNode===d)e+=i}else if(c>=b.nodeValue.length)b.parentNode.appendChild(a);else{h=b.splitText(c);b.parentNode.insertBefore(a,h);if(b===d){d=h;e-=c}}f?this.setStartBefore(f).setEndAfter(g):this.selectNode(a);return this.setEnd(d,e)},surroundContents:function(a){a.appendChild(this.extractContents());
return this.insertNode(a).selectNode(a)},get:function(){var a=this.doc,b=this.startContainer,c=this.startOffset,d=this.endContainer,e=this.endOffset;if(a.createRange){a=a.createRange();try{a.setStart(b,c);a.setEnd(d,e)}catch(f){}}else{a=a.body.createTextRange();a.setEndPoint("StartToStart",Ea(b,c));a.setEndPoint("EndToStart",Ea(d,e))}return a},html:function(){return j(this.cloneContents()).outer()}};y.range=X;y.START_TO_START=S;y.START_TO_END=R;y.END_TO_END=W;y.END_TO_START=N;var Ua=G("9,32,48..57,59,61,65..90,106,109..111,188,190..192,219..222"),
Va=G("8,13,33..40,46"),qa={};v(Ua,function(a,b){qa[a]=b});v(Va,function(a,b){qa[a]=b});na.prototype={select:function(){var a=this.sel,b=this.range.cloneRange(),c=b.startContainer,d=c.ownerDocument||c,e=d.parentWindow||d.defaultView;if(H&&c.nodeType==1&&b.collapsed){a=j("<span>&nbsp;</span>",d);b.insertNode(a.get());b=d.body.createTextRange();b.moveToElementText(a.get());b.collapse(false);b.select();a.remove();e.focus();return this}b=b.get();if(H)b.select();else{a.removeAllRanges();a.addRange(b)}e.focus();
return this},wrap:function(a){function b(o,n,w){var E=o.nodeValue.length,B=o;if(!(w<=n)){if(n>0)B=o.splitText(n);w<E&&B.splitText(w-n);var u;w=j(B);n=g==o;for(o=i==o;(u=w.parent())&&u.isInline()&&u.children().length==1;){n||(n=g==u.get());o||(o=i==u.get());w=u}u=w;w=f;w=w.clone(true);if(u.type==3){O(w).append(u.clone(false));u.before(w);u.remove()}else{E=u;for(var k;(k=u.first())&&k.children().length==1;)u=k;for(B=u.doc.createDocumentFragment();k=u.first();){k.next();B.appendChild(k.get())}w=Ka(E,
w);B.firstChild&&O(w).append(B);E.before(w);E.remove()}k=w.get();n&&e.setStartBefore(k);o&&e.setEndAfter(k)}}function c(o){var n=o.firstChild;if(o.nodeType==3){b(o,h,q);return false}for(var w;n;){o=X(d);o.selectNode(n);if(o.compareBoundaryPoints(N,e)>=0)return false;w=n.nextSibling;if(o.compareBoundaryPoints(R,e)>0)if(n.nodeType==1){if(c(n)===false)return false}else if(n.nodeType==3)if(n==g&&n==i)b(n,h,q);else if(n==g)b(n,h,n.nodeValue.length);else n==i?b(n,0,q):b(n,0,n.nodeValue.length);n=w}}var d=
this.doc,e=this.range,f,g=e.startContainer,h=e.startOffset,i=e.endContainer,q=e.endOffset;f=typeof a=="string"?j(a,d):a;if(e.collapsed){if(this._preformat)f=Ka(this._preformat.wrapper,f);this._preformat={wrapper:f,range:e.cloneRange()};return this}if(!f.isInline()){for(var m=a=f.clone(true);m.first();)m=m.first();m.append(e.extractContents());e.insertNode(a.get()).selectNode(a.get());return this}c(e.commonAncestorContainer);return this},split:function(a,b){for(var c=this.range,d=c.doc,e=c.cloneRange().collapse(a),
f=e.startContainer,g=e.startOffset,h=f.nodeType==3?f.parentNode:f,i=false;h&&h.parentNode;){var q=j(h);if(!q.isInline())break;if(!(T(q,b,"*")||T(q,b)))break;i=true;h=h.parentNode}if(i){d=d.createElement("span");c.cloneRange().collapse(!a).insertNode(d);a?e.setStartBefore(h.firstChild).setEnd(f,g):e.setStart(f,g).setEndAfter(h.lastChild);f=e.extractContents();g=f.firstChild;i=f.lastChild;if(a){e.insertNode(f);c.setStartAfter(i).setEndBefore(d)}else{h.appendChild(f);c.setStartBefore(d).setEndBefore(g)}e=
d.parentNode;e.removeChild(d);!a&&e===c.endContainer&&c.setEnd(c.endContainer,c.endOffset-1)}return this},remove:function(a){var b=this.doc,c=this.range;if(c.collapsed){this._preremove={map:a,range:c.cloneRange()};return this}this.split(true,a);this.split(false,a);var d=[];j(c.commonAncestorContainer).each(function(q){var m=X(b);m.selectNode(q.get());if(m.compareBoundaryPoints(N,c)>=0)return false;m.compareBoundaryPoints(S,c)>=0&&d.push(q)});var e=c.startContainer,f=c.startOffset,g=c.endContainer,
h=c.endOffset;if(f>0){var i=j(e.childNodes[f-1]);if(i&&O(i).isInline()){i.remove();c.setStart(e,f-1);e==g&&c.setEnd(g,h-1)}if((i=j(e.childNodes[f]))&&O(i).isInline()){i.remove();e==g&&c.setEnd(g,h-1)}}(e=j(g.childNodes[c.endOffset]))&&O(e).isInline()&&e.remove();v(d,function(){Ja(this,a,"*");Ja(this,a)});return this},_applyPreformat:function(){var a=this.range,b=this._preformat,c=this._preremove;if(b||c){b?a.setStart(b.range.startContainer,b.range.startOffset):a.setStart(c.range.startContainer,c.range.startOffset);
b&&this.wrap(b.wrapper);c&&this.remove(c.map);b=a.startContainer;c=a.startOffset;b=O(j(b.nodeType==3?b:b.childNodes[c])).get();a.setEnd(b,b.nodeValue.length);a.collapse(false);this.select();this._preremove=this._preformat=null}},exec:function(a,b){return this[a.toLowerCase()](b)},state:function(a){var b=this.doc,c=false;try{c=b.queryCommandState(a)}catch(d){}return c},val:function(a){var b=this.doc,c=this.range;a=a.toLowerCase();var d="";if(a==="fontfamily"||a==="fontname"){d=Fa(b,"fontname");d=d.replace(/['"]/g,
"");return d.toLowerCase()}if(a==="formatblock"){d=Fa(b,a);if(d==="")if(a=Y(c,{"h1,h2,h3,h4,h5,h6,p,div,pre,address":"*"}))d=a.name;if(d==="Normal")d="p";return d.toLowerCase()}if(a==="fontsize"){if(a=Y(c,{"*":".font-size"}))d=a.css("font-size");return d.toLowerCase()}if(a==="forecolor"){if(a=Y(c,{"*":".color"}))d=a.css("color");d=Z(d);if(d==="")d="default";return d.toLowerCase()}if(a==="hilitecolor"){if(a=Y(c,{"*":".background-color"}))d=a.css("background-color");d=Z(d);if(d==="")d="default";return d.toLowerCase()}return d},
toggle:function(a,b){Y(this.range,b)?this.remove(b):this.wrap(a);return this.select()},bold:function(){return this.toggle("<strong></strong>",{span:".font-weight=bold",strong:"*",b:"*"})},italic:function(){return this.toggle("<em></em>",{span:".font-style=italic",em:"*",i:"*"})},underline:function(){return this.toggle("<u></u>",{span:".text-decoration=underline",u:"*"})},strikethrough:function(){return this.toggle("<s></s>",{span:".text-decoration=line-through",s:"*"})},forecolor:function(a){return this.toggle('<span style="color:'+
a+';"></span>',{span:".color="+a,font:"color"})},hilitecolor:function(a){return this.toggle('<span style="background-color:'+a+';"></span>',{span:".background-color="+a})},fontsize:function(a){return this.toggle('<span style="font-size:'+a+';"></span>',{span:".font-size="+a,font:"size"})},fontname:function(a){return this.fontfamily(a)},fontfamily:function(a){return this.toggle('<span style="font-family:'+a+';"></span>',{span:".font-family="+a,font:"face"})},removeformat:function(){var a={"*":"class,style"};
v(Ta,function(b){a[b]="*"});this.remove(a);return this.select()},oninput:function(a){j(this.doc).bind("keyup",function(b){if(!b.ctrlKey&&!b.altKey&&Ua[b.which]){a(b);b.stop()}});return this},oncursormove:function(a){var b=this.doc;j(b).bind("keyup",function(c){if(!c.ctrlKey&&!c.altKey&&Va[c.which]){a(c);c.stop()}});j(b).bind("mouseup",a);return this},onchange:function(a){function b(e){setTimeout(function(){a(e)},1)}var c=this.doc,d=c.body;j(c).bind("keyup",function(e){if(!e.ctrlKey&&!e.altKey&&qa[e.which]){a(e);
e.stop()}});j(c).bind("mouseup",a);c!==document&&j(document).bind("mousedown",a);j(d).bind("paste",b);j(d).bind("cut",b);return this}};y.cmd=La;Ma.prototype={html:function(a){this.val(a)},val:function(a){return this.designMode?ca.call(this,a):da.call(this,a)},create:function(a){if(this.div)return this;a=j(a).addClass("ke-edit");var b=j('<iframe class="ke-edit-iframe" frameborder="0"></iframe>'),c=j('<textarea class="ke-edit-textarea"></textarea>'),d=this.srcElement,e={display:"block",width:this.width,
height:this.height};a.css(e);b.css(e);c.css(e);this.designMode?c.hide():b.hide();a.append(b);a.append(c);d.hide();e=b.get();e=e.contentDocument||e.contentWindow.document;e.designMode="on";e.open();e.write($a(this.bodyClass,this.cssData));e.close();this.div=a;this.iframe=b;this.textarea=c;this.doc=e;this.designMode?ca.call(this,oa(d)):da.call(this,oa(d));this.cmd=La(e);return this},remove:function(){var a=this.div,b=this.iframe,c=this.textarea,d=this.doc,e=this.srcElement;if(!a)return this;j(d).unbind();
j(d.body).unbind();j(document).unbind();oa(e,this.val());e.show();b.remove();c.remove();a.removeClass("ke-edit").css({display:"",width:"",height:""});this.div=this.iframe=this.textarea=null;return this},toggle:function(a){var b=this.iframe,c=this.textarea;if(!b)return this;if(a===x?!this.designMode:a){if(!this.designMode){c.hide();ca.call(this,da.call(this));b.show();this.designMode=true}}else if(this.designMode){b.hide();da.call(this,ca.call(this));c.show();this.designMode=false}return this},toDesign:function(){return this.toggle(true)},
toSource:function(){return this.toggle(false)},focus:function(){this.iframe&&this.designMode&&this.iframe.contentWindow.focus();return this}};y.edit=Na;Oa.prototype={addItem:function(a){this.items.push(a)},create:function(a){var b=this;if(b.div)return b;a=j(a).addClass("ke-toolbar").css({width:b.width});var c,d=j('<div class="ke-toolbar-inner"></div>');a.bind("contextmenu,dbclick",function(e){e.stop()});v(b.items,function(e,f){if(f.name=="|")c=j('<span class="ke-inline-block ke-toolbar-separator"></span>');
else if(f.name=="/")c=j("<br />");else{c=j('<a class="ke-inline-block ke-toolbar-icon-outline" href="#"></a>');c.append(j('<span class="ke-inline-block ke-toolbar-icon ke-toolbar-icon-url ke-icon-'+f.name+'"></span>'));c.bind("mouseover",function(g){this.addClass("ke-toolbar-icon-outline-on");g.stop()});c.bind("mouseout",function(g){this.removeClass("ke-toolbar-icon-outline-on");g.stop()});c.bind("click",function(g){f.click.call(this);g.stop()})}b.itemNodes.push(c);d.append(c)});b.div=a.append(d);
return b},remove:function(){if(!this.div)return this;v(this.itemNodes,function(){this.remove()});this.itemNodes=[];this.div.removeClass("ke-toolbar").css("width","").unbind();this.div.html("");this.div=null;return this},disable:function(){},enable:function(){}};y.toolbar=Pa;var Qa={},ab={designMode:true,fullscreenMode:false,filterMode:false,shadowMode:true,scriptPath:function(){for(var a=document.getElementsByTagName("script"),b,c=0,d=a.length;c<d;c++){b=a[c].src||"";if(b.match(/kindeditor[\w\-\.]*\.js/))return b.substring(0,
b.lastIndexOf("/")+1)}return""}(),urlType:"",newlineType:"p",resizeType:2,dialogAlignType:"page",bodyClass:"ke-content",cssData:"",minWidth:200,minHeight:100,minChangeSize:5,items:["source","|","fullscreen","undo","redo","print","cut","copy","paste","plainpaste","wordpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","|","selectall","/","formatblock","fontname","fontsize","|","forecolor","hilitecolor",
"bold","italic","underline","strikethrough","removeformat","|","image","flash","media","advtable","hr","emoticons","link","unlink","|","about"],colors:[["#E53333","#E56600","#FF9900","#64451D","#DFC5A4","#FFE500"],["#009900","#006600","#99BB00","#B8D100","#60D978","#00D5FF"],["#337FE5","#003399","#4C33E5","#9933E5","#CC33E5","#EE33EE"],["#FFFFFF","#CCCCCC","#999999","#666666","#333333","#000000"]],htmlTags:{font:["color","size","face",".background-color"],span:[".color",".background-color",".font-size",
".font-family",".background",".font-weight",".font-style",".text-decoration",".vertical-align"],div:["align",".border",".margin",".padding",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".background",".font-style",".text-decoration",".vertical-align",".margin-left"],table:["border","cellspacing","cellpadding","width","height","align","bordercolor",".padding",".margin",".border","bgcolor",".text-align",".color",".background-color",".font-size",".font-family",
".font-weight",".font-style",".text-decoration",".background",".width",".height"],"td,th":["align","valign","width","height","colspan","rowspan","bgcolor",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".font-style",".text-decoration",".vertical-align",".background"],a:["href","target","name"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess","/"],img:["src","width","height","border","alt","title",
".width",".height","/"],hr:["/"],br:["/"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["align",".text-align",".color",".background-color",".font-size",".font-family",".background",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],"tbody,tr,strong,b,sub,sup,em,i,u,strike":[]}};Ra.prototype={create:function(){var a=this,b=j("<div></div>").css({width:a.width}),c=j("<div></div>"),d=j("<div></div>"),e=j("<div></div>");b.append(c).append(d).append(e);a.fullscreenMode?
j(document.body).append(b):a.srcElement.before(b);var f=Pa({width:"100%"});b=Na({srcElement:a.srcElement,width:"100%",height:a.height,designMode:a.designMode,bodyClass:a.bodyClass,cssData:a.cssData}).create(d);v(a.items,function(g,h){f.addItem({name:h,click:function(){ea(h).click(a)}})});f.create(c);a.toolbar=f;a.edit=b;return a}};var bb=[];if(H&&U<7)try{document.execCommand("BackgroundImageCache",false,true)}catch(gb){}ea("source",{click:function(a){a.edit.toggle()}});v("bold,italic,underline,strikethrough,removeformat".split(","),
function(a,b){ea(b,{click:function(c){c.edit.cmd[b]()}})});y.create=Sa;y.plugin=ea;pa=y;y=function(a,b){sa(function(){Sa(a,b)})};v(pa,function(a,b){y[a]=b});if(fa.K===x)fa.K=y;fa.KindEditor=y})(window);
