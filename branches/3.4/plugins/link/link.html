<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Link</title>
    <style type="text/css" rel="stylesheet">
        body {
            font-size:12px;
            font-family: "sans serif",tahoma,verdana,helvetica;
            margin: 5px;
            background-color:#F0F0EE;
        }
        td.left {
            font-size: 12px;
            width: 70px;
            padding: 2px;
        }
        td.right {
            padding: 2px;
        }
    </style>
    <script type="text/javascript">
        var KE = parent.KE;
        location.href.match(/\?id=([\w-]+)/i);
        var id = RegExp.$1;
        KE.event.ready(function() {
            var hyperLink = KE.$('hyperLink', document);
            var linkType = KE.$('linkType', document);
            var linkNode = KE.plugin['link'].getSelectedNode(id);
            if (linkNode) {
                var src = KE.format.getUrl(linkNode.href, KE.g[id].urlType);
                var target = linkNode.target;
                hyperLink.value = src;
                linkType.value = target == '_blank' ? target : '_self';
                var range = KE.g[id].keRange;
                range.selectTextNode(linkNode);
                KE.g[id].keSel.addRange(range);
            }
            KE.util.hideLoadingPage(id);
        }, window, document);
    </script>
</head>
<body>
  <table border="0" cellpadding="0" cellspacing="0">
    <tr>
      <td class="left">URL: </td>
      <td class="right"><input type="text" id="hyperLink" name="hyperLink" value="http://" style="width:200px;" /></td>
    </tr>
    <tr>
      <td class="left">打开类型: </td>
      <td class="right">
        <select id="linkType" name="linkType">
          <option value="_blank">新窗口</option>
          <option value="_self">当前窗口</option>
        </select>
      </td>
    </tr>
  </table>
</body>
</html>
